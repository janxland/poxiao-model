{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/**\n * tdesign v1.9.0\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _defineProperty } from '../_chunks/dep-7deaa3b9.mjs';\nimport { positiveAdd, positiveSubtract } from '../_common/js/input-number/number.mjs';\nimport { ref, watch } from 'vue';\nimport '../_chunks/dep-8dbc9855.mjs';\nimport '../_chunks/dep-ac561548.mjs';\nimport '../_chunks/dep-cb814df4.mjs';\nimport '../_chunks/dep-30b3f256.mjs';\nimport '../_chunks/dep-cd533155.mjs';\nimport '../_chunks/dep-ab439391.mjs';\nimport '../_chunks/dep-60d62610.mjs';\nimport '../_chunks/dep-2adf18a2.mjs';\nimport '../_chunks/dep-0e4de31a.mjs';\nimport '../_common/js/input-number/large-number.mjs';\nimport '../_chunks/dep-b089fa1f.mjs';\nimport '../_chunks/dep-8e411f1c.mjs';\nimport '../_common/js/log/log.mjs';\nimport '../_common/js/log/index.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nfunction useDrag(initTransform) {\n  var transform = ref(initTransform);\n  var mouseDownHandler = function mouseDownHandler(e) {\n    var startX = e.pageX,\n      startY = e.pageY;\n    var _transform$value = transform.value,\n      translateX = _transform$value.translateX,\n      translateY = _transform$value.translateY;\n    var mouseMoveHandler = function mouseMoveHandler(e2) {\n      var pageX = e2.pageX,\n        pageY = e2.pageY;\n      transform.value = {\n        translateX: translateX + pageX - startX,\n        translateY: translateY + pageY - startY\n      };\n    };\n    var mouseUpHandler = function mouseUpHandler() {\n      document.removeEventListener(\"mousemove\", mouseMoveHandler);\n      document.removeEventListener(\"mouseup\", mouseUpHandler);\n    };\n    document.addEventListener(\"mousemove\", mouseMoveHandler);\n    document.addEventListener(\"mouseup\", mouseUpHandler);\n  };\n  var resetTransform = function resetTransform() {\n    transform.value = _objectSpread({}, initTransform);\n  };\n  return {\n    transform: transform,\n    mouseDownHandler: mouseDownHandler,\n    resetTransform: resetTransform\n  };\n}\nfunction useMirror() {\n  var mirror = ref(1);\n  var onMirror = function onMirror() {\n    mirror.value *= -1;\n  };\n  var resetMirror = function resetMirror() {\n    mirror.value = 1;\n  };\n  return {\n    mirror: mirror,\n    onMirror: onMirror,\n    resetMirror: resetMirror\n  };\n}\nfunction useScale() {\n  var imageScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n    max: 2,\n    min: 0.5,\n    step: 0.5\n  };\n  var max = imageScale.max,\n    min = imageScale.min,\n    step = imageScale.step,\n    defaultScale = imageScale.defaultScale;\n  var scale = ref(defaultScale !== null && defaultScale !== void 0 ? defaultScale : 1);\n  var onZoomIn = function onZoomIn() {\n    var result = positiveAdd(scale.value, step);\n    setScale(result);\n  };\n  var onZoomOut = function onZoomOut() {\n    var result = positiveSubtract(scale.value, step);\n    setScale(result);\n  };\n  var resetScale = function resetScale() {\n    scale.value = defaultScale !== null && defaultScale !== void 0 ? defaultScale : 1;\n  };\n  var setScale = function setScale(newScale) {\n    var value = newScale;\n    if (newScale < min) {\n      value = min;\n    }\n    if (newScale > max) {\n      value = max;\n    }\n    scale.value = value;\n  };\n  watch(function () {\n    return imageScale;\n  }, function () {\n    return resetScale();\n  });\n  return {\n    scale: scale,\n    onZoomIn: onZoomIn,\n    onZoomOut: onZoomOut,\n    resetScale: resetScale\n  };\n}\nfunction useRotate() {\n  var rotate = ref(0);\n  var ROTATE_DEG = 90;\n  var onRotate = function onRotate() {\n    rotate.value += ROTATE_DEG;\n  };\n  var resetRotate = function resetRotate() {\n    rotate.value = 0;\n  };\n  return {\n    rotate: rotate,\n    onRotate: onRotate,\n    resetRotate: resetRotate\n  };\n}\nexport { useDrag, useMirror, useRotate, useScale };","map":{"version":3,"names":["useDrag","initTransform","transform","ref","mouseDownHandler","e","startX","pageX","startY","pageY","_transform$value","value","translateX","translateY","mouseMoveHandler","e2","mouseUpHandler","document","removeEventListener","addEventListener","resetTransform","_objectSpread","useMirror","mirror","onMirror","resetMirror","useScale","imageScale","arguments","length","undefined","max","min","step","defaultScale","scale","onZoomIn","result","positiveAdd","setScale","onZoomOut","positiveSubtract","resetScale","newScale","watch","useRotate","rotate","ROTATE_DEG","onRotate","resetRotate"],"sources":["../../src/image-viewer/hooks.ts"],"sourcesContent":["import { positiveSubtract, positiveAdd } from '../_common/js/input-number/number';\nimport { ref, watch } from 'vue';\nimport { ImageScale } from './type';\n\ninterface InitTransform {\n  translateX: number;\n  translateY: number;\n}\n\nexport function useDrag(initTransform: InitTransform) {\n  const transform = ref(initTransform);\n\n  const mouseDownHandler = (e: MouseEvent) => {\n    const { pageX: startX, pageY: startY } = e;\n    const { translateX, translateY } = transform.value;\n    const mouseMoveHandler = (e: MouseEvent) => {\n      const { pageX, pageY } = e;\n      transform.value = {\n        translateX: translateX + pageX - startX,\n        translateY: translateY + pageY - startY,\n      };\n    };\n    const mouseUpHandler = () => {\n      document.removeEventListener('mousemove', mouseMoveHandler);\n      document.removeEventListener('mouseup', mouseUpHandler);\n    };\n\n    document.addEventListener('mousemove', mouseMoveHandler);\n    document.addEventListener('mouseup', mouseUpHandler);\n  };\n\n  const resetTransform = () => {\n    transform.value = { ...initTransform };\n  };\n\n  return { transform, mouseDownHandler, resetTransform };\n}\n\nexport function useMirror() {\n  const mirror = ref(1);\n  const onMirror = () => {\n    mirror.value *= -1;\n  };\n  const resetMirror = () => {\n    mirror.value = 1;\n  };\n\n  return { mirror, onMirror, resetMirror };\n}\n\nexport function useScale(imageScale: ImageScale = { max: 2, min: 0.5, step: 0.5 }) {\n  const { max, min, step, defaultScale } = imageScale;\n  const scale = ref(defaultScale ?? 1);\n  const onZoomIn = () => {\n    const result = positiveAdd(scale.value, step);\n    setScale(result);\n  };\n  const onZoomOut = () => {\n    const result = positiveSubtract(scale.value, step);\n    setScale(result);\n  };\n  const resetScale = () => {\n    scale.value = defaultScale ?? 1;\n  };\n\n  const setScale = (newScale: number) => {\n    let value = newScale;\n    if (newScale < min) {\n      value = min;\n    }\n    if (newScale > max) {\n      value = max;\n    }\n    scale.value = value;\n  };\n\n  watch(\n    () => imageScale,\n    () => resetScale(),\n  );\n\n  return { scale, onZoomIn, onZoomOut, resetScale };\n}\n\nexport function useRotate() {\n  const rotate = ref(0);\n  const ROTATE_DEG = 90;\n\n  const onRotate = () => {\n    rotate.value += ROTATE_DEG;\n  };\n  const resetRotate = () => {\n    rotate.value = 0;\n  };\n\n  return { rotate, onRotate, resetRotate };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}