{"ast":null,"code":"/**\n * tdesign v1.9.0\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _slicedToArray } from '../../_chunks/dep-b089fa1f.mjs';\nimport '../adapt.mjs';\nimport { getNode, pathMatchClass } from '../util.mjs';\nimport { usePrefixClass } from '../../hooks/useConfig.mjs';\nimport '../../_chunks/dep-8e411f1c.mjs';\nimport 'vue';\nimport '../../utils/withInstall.mjs';\nimport '../../hooks/useVModel.mjs';\nimport '../../_chunks/dep-bd7cd061.mjs';\nimport '../../_chunks/dep-cb814df4.mjs';\nimport '../../_chunks/dep-96484611.mjs';\nimport '../../_chunks/dep-67e59a11.mjs';\nimport '../../_chunks/dep-cd533155.mjs';\nimport '../../_chunks/dep-8dbc9855.mjs';\nimport '../../_chunks/dep-ab439391.mjs';\nimport '../../_chunks/dep-60d62610.mjs';\nimport '../../_chunks/dep-10024af3.mjs';\nimport '../../_chunks/dep-2adf18a2.mjs';\nimport '../../hooks/useDefaultValue.mjs';\nimport 'tdesign-icons-vue-next';\nimport '../../checkbox/index.mjs';\nimport '../../checkbox/checkbox.mjs';\nimport '../../_chunks/dep-7deaa3b9.mjs';\nimport '../../checkbox/props.mjs';\nimport '../../hooks/useRipple.mjs';\nimport '../../hooks/useKeepAnimation.mjs';\nimport '../../_chunks/dep-b3734774.mjs';\nimport '../../_chunks/dep-e5142249.mjs';\nimport '../../_chunks/dep-c4f80cb4.mjs';\nimport '../../_chunks/dep-996b4900.mjs';\nimport '../../_chunks/dep-66473aa9.mjs';\nimport '../../_chunks/dep-715774e0.mjs';\nimport '../../_chunks/dep-5a5a1764.mjs';\nimport '../../_chunks/dep-3108c312.mjs';\nimport '../../_chunks/dep-93498383.mjs';\nimport '../../_chunks/dep-36582a92.mjs';\nimport '../../_chunks/dep-a2db6df1.mjs';\nimport '../../_chunks/dep-0f89a1dd.mjs';\nimport '../../_chunks/dep-d4da440a.mjs';\nimport '../../_chunks/dep-013382c3.mjs';\nimport '../../_chunks/dep-ca764006.mjs';\nimport '../../_chunks/dep-2ee9d497.mjs';\nimport '../../_chunks/dep-a4a3ac25.mjs';\nimport '../../_chunks/dep-6861d388.mjs';\nimport '../../_chunks/dep-396d852b.mjs';\nimport '../../_chunks/dep-8a3fd140.mjs';\nimport '../../_chunks/dep-5db0da5c.mjs';\nimport '../../_common/js/global-config/default-config.mjs';\nimport '../../_common/js/global-config/locale/zh_CN.mjs';\nimport '../../_chunks/dep-bf19d9ba.mjs';\nimport '../../_chunks/dep-6963a882.mjs';\nimport '../../config-provider/useConfig.mjs';\nimport '../../_chunks/dep-37e3e644.mjs';\nimport '../../_chunks/dep-31dc0415.mjs';\nimport '../../_chunks/dep-c545db54.mjs';\nimport '../../_chunks/dep-3f15cb30.mjs';\nimport '../../_chunks/dep-fd2b6c64.mjs';\nimport '../../_chunks/dep-30b3f256.mjs';\nimport '../../config-provider/type.mjs';\nimport '../../utils/set-style.mjs';\nimport '../../hooks/tnode.mjs';\nimport '../../_chunks/dep-f8909853.mjs';\nimport '../../_chunks/dep-d00e2e04.mjs';\nimport '../../_chunks/dep-ec2f76cc.mjs';\nimport '../../utils/render-tnode.mjs';\nimport '../../_chunks/dep-60ee423b.mjs';\nimport '../../checkbox/constants.mjs';\nimport '../../checkbox/hooks/useCheckboxLazyLoad.mjs';\nimport '../../_common/js/utils/observe.mjs';\nimport '../../checkbox/hooks/useKeyboardEvent.mjs';\nimport '../../_common/js/common.mjs';\nimport '../../hooks/useDisabled.mjs';\nimport '../../_chunks/dep-03dfef8f.mjs';\nimport '../../checkbox/group.mjs';\nimport '../../_chunks/dep-b15588b0.mjs';\nimport '../../_chunks/dep-c628112b.mjs';\nimport '../../_chunks/dep-1aab510a.mjs';\nimport '../../_chunks/dep-931fe368.mjs';\nimport '../../_chunks/dep-ac561548.mjs';\nimport '../../checkbox/checkbox-group-props.mjs';\nimport '../../hooks/slot.mjs';\nimport './style/css.mjs';\nimport '../../checkbox/type.mjs';\nimport '../../loading/index.mjs';\nimport '../../_chunks/dep-503b7515.mjs';\nimport '../../_chunks/dep-e32ac680.mjs';\nimport '../../_chunks/dep-230c1b47.mjs';\nimport '../../_chunks/dep-cedc2818.mjs';\nimport '../../_chunks/dep-8dae3bca.mjs';\nimport '../../_chunks/dep-41db3bc9.mjs';\nimport '../../_chunks/dep-da57e0cf.mjs';\nimport '../../loading/plugin.mjs';\nimport '../../loading/loading.mjs';\nimport '../../loading/icon/gradient.mjs';\nimport '../../_common/js/loading/circle-adapter.mjs';\nimport '../../_common/js/utils/set-style.mjs';\nimport '../../_common/js/utils/helper.mjs';\nimport '../../_chunks/dep-807e1747.mjs';\nimport '../../_chunks/dep-413fbf03.mjs';\nimport '../../_chunks/dep-0e4de31a.mjs';\nimport '../../utils/dom.mjs';\nimport '../../utils/easing.mjs';\nimport '../../loading/props.mjs';\nimport '../../hooks/useTeleport.mjs';\nimport '../../loading/type.mjs';\nimport '../../hooks/useGlobalIcon.mjs';\nimport '../../hooks/useLazyLoad.mjs';\nimport '../../hooks/useVirtualScrollNew.mjs';\nimport '../../hooks/useResizeObserver.mjs';\nimport '../../_chunks/dep-cede586b.mjs';\nimport '../../_chunks/dep-665d45b4.mjs';\nimport '../../_chunks/dep-27be073b.mjs';\nimport '../../_common/js/tree/tree-node.mjs';\nimport '../../_chunks/dep-f14cdac0.mjs';\nimport '../../_chunks/dep-12bcaf4a.mjs';\nimport '../../_chunks/dep-d0177ed3.mjs';\nimport '../../_chunks/dep-cd711cee.mjs';\nimport '../../_common/js/tree/tree-node-model.mjs';\nimport '../../_chunks/dep-8fdb2da0.mjs';\nimport '../../_chunks/dep-d7c36095.mjs';\nimport '../../_chunks/dep-4481f632.mjs';\nimport '../../_common/js/log/log.mjs';\nimport '../../_common/js/log/index.mjs';\nfunction useTreeAction(state) {\n  var treeState = state;\n  var store = treeState.store;\n  var componentName = usePrefixClass(\"tree\").value;\n  var _state$vmValue = _slicedToArray(state.vmValue, 2),\n    tValue = _state$vmValue[0],\n    setTValue = _state$vmValue[1];\n  var _state$vmActived = _slicedToArray(state.vmActived, 2),\n    tActived = _state$vmActived[0],\n    setTActived = _state$vmActived[1];\n  var _state$vmExpanded = _slicedToArray(state.vmExpanded, 2),\n    tExpanded = _state$vmExpanded[0],\n    setTExpanded = _state$vmExpanded[1];\n  var setExpanded = function setExpanded(item, isExpanded) {\n    var node = getNode(store, item);\n    var mouseEvent = treeState.mouseEvent;\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: \"setItem\"\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = \"node-click\";\n      var target = mouseEvent.target;\n      var currentTarget = mouseEvent.currentTarget;\n      if (pathMatchClass(\"\".concat(componentName, \"__icon\"), target, currentTarget)) {\n        evtCtx.trigger = \"icon-click\";\n      }\n    }\n    var expanded = node.setExpanded(isExpanded, {\n      directly: true\n    });\n    setTExpanded(expanded, evtCtx);\n    if (evtCtx.trigger !== \"setItem\") {\n      store.replaceExpanded(tExpanded.value || []);\n    }\n    return expanded;\n  };\n  var toggleExpanded = function toggleExpanded(item) {\n    var node = getNode(store, item);\n    return setExpanded(node, !node.isExpanded());\n  };\n  var setActived = function setActived(item, isActived) {\n    var node = getNode(store, item);\n    var mouseEvent = treeState.mouseEvent;\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: \"setItem\"\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = \"node-click\";\n    }\n    var actived = node.setActived(isActived, {\n      isAction: evtCtx.trigger === \"node-click\",\n      directly: true\n    });\n    setTActived(actived, evtCtx);\n    if (evtCtx.trigger !== \"setItem\") {\n      store.replaceActived(tActived.value || []);\n    }\n    return actived;\n  };\n  var toggleActived = function toggleActived(item) {\n    var node = getNode(store, item);\n    return setActived(node, !node.isActived());\n  };\n  var setChecked = function setChecked(item, isChecked, ctx) {\n    var node = getNode(store, item);\n    var mouseEvent = ctx === null || ctx === void 0 ? void 0 : ctx.e;\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: \"setItem\"\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = \"node-click\";\n    }\n    var checked = node.setChecked(isChecked, {\n      isAction: evtCtx.trigger === \"node-click\",\n      directly: true\n    });\n    setTValue(checked, evtCtx);\n    if (evtCtx.trigger !== \"setItem\") {\n      store.replaceChecked(tValue.value || []);\n    }\n    return checked;\n  };\n  var toggleChecked = function toggleChecked(item, ctx) {\n    var node = getNode(store, item);\n    if (node.isIndeterminate()) {\n      var expectState = node.hasEnableUnCheckedChild();\n      return setChecked(node, expectState, ctx);\n    }\n    return setChecked(node, !node.isChecked(), ctx);\n  };\n  return {\n    setExpanded: setExpanded,\n    toggleExpanded: toggleExpanded,\n    setActived: setActived,\n    toggleActived: toggleActived,\n    setChecked: setChecked,\n    toggleChecked: toggleChecked\n  };\n}\nexport { useTreeAction as default };","map":{"version":3,"names":["useTreeAction","state","treeState","store","componentName","usePrefixClass","value","_state$vmValue","_slicedToArray","vmValue","tValue","setTValue","_state$vmActived","vmActived","tActived","setTActived","_state$vmExpanded","vmExpanded","tExpanded","setTExpanded","setExpanded","item","isExpanded","node","getNode","mouseEvent","evtCtx","getModel","e","trigger","target","currentTarget","pathMatchClass","concat","expanded","directly","replaceExpanded","toggleExpanded","setActived","isActived","actived","isAction","replaceActived","toggleActived","setChecked","isChecked","ctx","checked","replaceChecked","toggleChecked","isIndeterminate","expectState","hasEnableUnCheckedChild"],"sources":["../../../src/tree/hooks/useTreeAction.ts"],"sourcesContent":["import { usePrefixClass } from '../adapt';\nimport {\n  TreeNodeValue,\n  TypeTreeState,\n  TypeTargetNode,\n  TypeExpandEventContext,\n  TypeActiveEventContext,\n  TypeChangeEventContext,\n} from '../tree-types';\nimport { getNode, pathMatchClass } from '../util';\n\n// tree 组件节点状态设置\nexport default function useTreeAction(state: TypeTreeState) {\n  const treeState = state;\n  const { store } = treeState;\n  const componentName = usePrefixClass('tree').value;\n\n  const [tValue, setTValue] = state.vmValue;\n  const [tActived, setTActived] = state.vmActived;\n  const [tExpanded, setTExpanded] = state.vmExpanded;\n\n  const setExpanded = (item: TypeTargetNode, isExpanded: boolean): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    const mouseEvent = treeState.mouseEvent as MouseEvent;\n    const evtCtx: TypeExpandEventContext = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: 'setItem',\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = 'node-click';\n      const target = mouseEvent.target as HTMLElement;\n      const currentTarget = mouseEvent.currentTarget as HTMLElement;\n      if (pathMatchClass(`${componentName}__icon`, target, currentTarget)) {\n        evtCtx.trigger = 'icon-click';\n      }\n    }\n    const expanded = node.setExpanded(isExpanded, {\n      directly: true,\n    });\n    setTExpanded(expanded, evtCtx);\n    if (evtCtx.trigger !== 'setItem') {\n      store.replaceExpanded((tExpanded.value || []) as TreeNodeValue[]);\n    }\n    return expanded;\n  };\n\n  const toggleExpanded = (item: TypeTargetNode): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    return setExpanded(node, !node.isExpanded());\n  };\n\n  const setActived = (item: TypeTargetNode, isActived: boolean) => {\n    const node = getNode(store, item);\n    const mouseEvent = treeState.mouseEvent as MouseEvent;\n    const evtCtx: TypeActiveEventContext = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: 'setItem',\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = 'node-click';\n    }\n    const actived = node.setActived(isActived, {\n      isAction: evtCtx.trigger === 'node-click',\n      directly: true,\n    });\n    setTActived(actived, evtCtx);\n    if (evtCtx.trigger !== 'setItem') {\n      store.replaceActived((tActived.value || []) as TreeNodeValue[]);\n    }\n    return actived;\n  };\n\n  const toggleActived = (item: TypeTargetNode): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    return setActived(node, !node.isActived());\n  };\n\n  const setChecked = (item: TypeTargetNode, isChecked: boolean, ctx: { e: Event }): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    const mouseEvent = ctx?.e as MouseEvent;\n    const evtCtx: TypeChangeEventContext = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: 'setItem',\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = 'node-click';\n    }\n    const checked = node.setChecked(isChecked, {\n      isAction: evtCtx.trigger === 'node-click',\n      directly: true,\n    });\n    setTValue(checked, evtCtx);\n    // 这是针对受控执行的操作，如果 props.value 未变更，则执行还原操作\n    if (evtCtx.trigger !== 'setItem') {\n      store.replaceChecked((tValue.value || []) as TreeNodeValue[]);\n    }\n    return checked;\n  };\n\n  const toggleChecked = (item: TypeTargetNode, ctx: { e: Event }): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    if (node.isIndeterminate()) {\n      const expectState = node.hasEnableUnCheckedChild();\n      return setChecked(node, expectState, ctx);\n    }\n    return setChecked(node, !node.isChecked(), ctx);\n  };\n\n  return {\n    setExpanded,\n    toggleExpanded,\n    setActived,\n    toggleActived,\n    setChecked,\n    toggleChecked,\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}