{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/**\n * tdesign v1.9.0\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _defineProperty } from '../_chunks/dep-7deaa3b9.mjs';\nimport { defineComponent, reactive, h, createApp } from 'vue';\nimport _Loading from './loading.mjs';\nimport { getAttach, addClass, removeClass } from '../utils/dom.mjs';\nimport { usePrefixClass } from '../hooks/useConfig.mjs';\nimport '../_chunks/dep-8dbc9855.mjs';\nimport '../_chunks/dep-b089fa1f.mjs';\nimport '../_chunks/dep-8e411f1c.mjs';\nimport './icon/gradient.mjs';\nimport '../_common/js/loading/circle-adapter.mjs';\nimport '../_common/js/utils/set-style.mjs';\nimport '../_common/js/utils/helper.mjs';\nimport '../_chunks/dep-b15588b0.mjs';\nimport '../_chunks/dep-807e1747.mjs';\nimport '../_chunks/dep-30b3f256.mjs';\nimport '../_chunks/dep-cb814df4.mjs';\nimport '../_chunks/dep-cd533155.mjs';\nimport '../_chunks/dep-ab439391.mjs';\nimport '../_chunks/dep-60d62610.mjs';\nimport '../_chunks/dep-2adf18a2.mjs';\nimport '../_chunks/dep-413fbf03.mjs';\nimport '../_chunks/dep-ac561548.mjs';\nimport '../_chunks/dep-0e4de31a.mjs';\nimport '../utils/render-tnode.mjs';\nimport '../_chunks/dep-60ee423b.mjs';\nimport '../_chunks/dep-c545db54.mjs';\nimport '../_chunks/dep-d4da440a.mjs';\nimport '../_chunks/dep-013382c3.mjs';\nimport '../_chunks/dep-66473aa9.mjs';\nimport '../_chunks/dep-715774e0.mjs';\nimport '../_chunks/dep-5a5a1764.mjs';\nimport '../_chunks/dep-3108c312.mjs';\nimport '../_chunks/dep-ca764006.mjs';\nimport '../_chunks/dep-996b4900.mjs';\nimport '../_chunks/dep-3f15cb30.mjs';\nimport '../_chunks/dep-0f89a1dd.mjs';\nimport '../_chunks/dep-f8909853.mjs';\nimport '../_chunks/dep-67e59a11.mjs';\nimport '../_chunks/dep-10024af3.mjs';\nimport '../_chunks/dep-d00e2e04.mjs';\nimport '../_chunks/dep-ec2f76cc.mjs';\nimport '../_chunks/dep-96484611.mjs';\nimport '../_chunks/dep-bd7cd061.mjs';\nimport './props.mjs';\nimport '../hooks/useTeleport.mjs';\nimport '../utils/easing.mjs';\nimport '../config-provider/useConfig.mjs';\nimport '../_chunks/dep-37e3e644.mjs';\nimport '../_chunks/dep-31dc0415.mjs';\nimport '../_chunks/dep-e5142249.mjs';\nimport '../_chunks/dep-c4f80cb4.mjs';\nimport '../_chunks/dep-93498383.mjs';\nimport '../_chunks/dep-36582a92.mjs';\nimport '../_chunks/dep-a2db6df1.mjs';\nimport '../_chunks/dep-2ee9d497.mjs';\nimport '../_chunks/dep-fd2b6c64.mjs';\nimport '../_chunks/dep-b3734774.mjs';\nimport '../_chunks/dep-a4a3ac25.mjs';\nimport '../_chunks/dep-6861d388.mjs';\nimport '../_chunks/dep-396d852b.mjs';\nimport '../_chunks/dep-8a3fd140.mjs';\nimport '../_chunks/dep-5db0da5c.mjs';\nimport '../_common/js/global-config/default-config.mjs';\nimport '../_common/js/global-config/locale/zh_CN.mjs';\nimport '../_chunks/dep-bf19d9ba.mjs';\nimport '../_chunks/dep-6963a882.mjs';\nimport '../config-provider/type.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nvar fullScreenLoadingInstance = null;\nfunction createLoading(props) {\n  var component = defineComponent({\n    setup: function setup() {\n      var loadingOptions = reactive(props);\n      return {\n        loadingOptions: loadingOptions\n      };\n    },\n    render: function render() {\n      return h(_Loading, _objectSpread({}, this.loadingOptions));\n    }\n  });\n  var attach = getAttach(props.attach);\n  var app = createApp(component);\n  var loading = app.mount(document.createElement(\"div\"));\n  var parentRelativeClass = usePrefixClass(\"loading__parent--relative\").value;\n  var prefixClass = usePrefixClass(\"loading\");\n  if (attach) {\n    addClass(attach, parentRelativeClass);\n  } else {\n    console.error(\"attach is not exist\");\n  }\n  var loadingInstance = {\n    hide: function hide() {\n      var _attach$querySelector;\n      loading.loading = false;\n      (_attach$querySelector = attach.querySelectorAll(\".\".concat(prefixClass.value))) === null || _attach$querySelector === void 0 || _attach$querySelector.forEach(function (item) {\n        item.remove();\n      });\n      removeClass(attach, parentRelativeClass);\n      app.unmount();\n    }\n  };\n  return loadingInstance;\n}\nfunction produceLoading(props) {\n  var lockClass = usePrefixClass(\"loading--lock\");\n  if (props === true) {\n    fullScreenLoadingInstance = createLoading({\n      fullscreen: true,\n      loading: true,\n      attach: \"body\"\n    });\n    return fullScreenLoadingInstance;\n  }\n  removeClass(document.body, lockClass.value);\n  if (props === false) {\n    removeClass(document.body, lockClass.value);\n    fullScreenLoadingInstance.hide();\n    fullScreenLoadingInstance = null;\n    return;\n  }\n  return createLoading(props);\n}\nvar LoadingPlugin = produceLoading;\nLoadingPlugin.install = function (app) {\n  app.config.globalProperties.$loading = produceLoading;\n};\nexport { LoadingPlugin as default };","map":{"version":3,"names":["fullScreenLoadingInstance","createLoading","props","component","defineComponent","setup","loadingOptions","reactive","render","h","_Loading","_objectSpread","attach","getAttach","app","createApp","loading","mount","document","createElement","parentRelativeClass","usePrefixClass","value","prefixClass","addClass","console","error","loadingInstance","hide","_attach$querySelector","querySelectorAll","concat","forEach","item","remove","removeClass","unmount","produceLoading","lockClass","fullscreen","body","LoadingPlugin","install","config","globalProperties","$loading"],"sources":["../../src/loading/plugin.tsx"],"sourcesContent":["import { App, Plugin, createApp, defineComponent, h, reactive } from 'vue';\nimport LoadingComponent from './loading';\nimport { getAttach, removeClass, addClass } from '../utils/dom';\nimport { TdLoadingProps, LoadingInstance, LoadingMethod } from './type';\nimport { usePrefixClass } from '../hooks/useConfig';\n\nlet fullScreenLoadingInstance: LoadingInstance = null;\n\nfunction createLoading(props: TdLoadingProps): LoadingInstance {\n  const component = defineComponent({\n    setup() {\n      const loadingOptions = reactive(props);\n      return {\n        loadingOptions,\n      };\n    },\n    render() {\n      return h(LoadingComponent, {\n        ...this.loadingOptions,\n      });\n    },\n  });\n\n  const attach = getAttach(props.attach);\n\n  const app = createApp(component);\n  const loading = app.mount(document.createElement('div'));\n  const parentRelativeClass = usePrefixClass('loading__parent--relative').value;\n  const prefixClass = usePrefixClass('loading');\n\n  if (attach) {\n    addClass(attach, parentRelativeClass);\n  } else {\n    console.error('attach is not exist');\n  }\n\n  const loadingInstance: LoadingInstance = {\n    hide: () => {\n      loading.loading = false;\n      attach.querySelectorAll(`.${prefixClass.value}`)?.forEach((item) => {\n        item.remove();\n      });\n      removeClass(attach, parentRelativeClass);\n      app.unmount();\n    },\n  };\n  return loadingInstance;\n}\n\nfunction produceLoading(props: boolean | TdLoadingProps): LoadingInstance {\n  const lockClass = usePrefixClass('loading--lock');\n\n  // 全屏加载\n  if (props === true) {\n    fullScreenLoadingInstance = createLoading({\n      fullscreen: true,\n      loading: true,\n      attach: 'body',\n    });\n    return fullScreenLoadingInstance;\n  }\n  removeClass(document.body, lockClass.value);\n\n  if (props === false) {\n    // 销毁全屏实例\n    removeClass(document.body, lockClass.value);\n    fullScreenLoadingInstance.hide();\n    fullScreenLoadingInstance = null;\n    return;\n  }\n  return createLoading(props);\n}\n\nexport type LoadingPluginType = Plugin & LoadingMethod;\n\nconst LoadingPlugin: LoadingPluginType = produceLoading as LoadingPluginType;\n\nLoadingPlugin.install = (app: App) => {\n  // eslint-disable-next-line no-param-reassign\n  app.config.globalProperties.$loading = produceLoading;\n};\n\nexport default LoadingPlugin;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA,IAAIA,yBAA6C;AAEjD,SAASC,cAAcC,KAAwC;EAC7D,IAAMC,SAAA,GAAYC,eAAgB;IAChCC,KAAQ,WAAAA,MAAA;MACA,IAAAC,cAAA,GAAiBC,QAAA,CAASL,KAAK;MAC9B;QACLI,cAAA,EAAAA;OACF;KACF;IACAE,MAAS,WAAAA,OAAA;MACP,OAAOC,CAAA,CAAEC,QAAkB,EAAAC,aAAA,KACtB,IAAK,CAAAL,cAAA,CACT;IACH;EACF,CAAC;EAEK,IAAAM,MAAA,GAASC,SAAU,CAAAX,KAAA,CAAMU,MAAM;EAE/B,IAAAE,GAAA,GAAMC,SAAA,CAAUZ,SAAS;EAC/B,IAAMa,OAAA,GAAUF,GAAI,CAAAG,KAAA,CAAMC,QAAS,CAAAC,aAAA,CAAc,KAAK,CAAC;EACjD,IAAAC,mBAAA,GAAsBC,cAAe,4BAA2B,CAAE,CAAAC,KAAA;EAClE,IAAAC,WAAA,GAAcF,cAAA,CAAe,SAAS;EAE5C,IAAIT,MAAQ;IACVY,QAAA,CAASZ,MAAA,EAAQQ,mBAAmB;EACtC,CAAO;IACLK,OAAA,CAAQC,KAAA,CAAM,qBAAqB;EACrC;EAEA,IAAMC,eAAmC;IACvCC,IAAA,EAAM,SAAAA,KAAA,EAAM;MAAA,IAAAC,qBAAA;MACVb,OAAA,CAAQA,OAAU;MAClB,CAAAa,qBAAA,GAAAjB,MAAA,CAAOkB,gBAAA,KAAAC,MAAA,CAAqBR,WAAA,CAAYD,KAAA,CAAO,CAAG,cAAAO,qBAAA,KAAlD,UAAAA,qBAAA,CAAkDG,OAAA,CAAQ,UAACC,IAAS;QAClEA,IAAA,CAAKC,MAAO;MACd,CAAC;MACDC,WAAA,CAAYvB,MAAA,EAAQQ,mBAAmB;MACvCN,GAAA,CAAIsB,OAAQ;IACd;GACF;EACO,OAAAT,eAAA;AACT;AAEA,SAASU,eAAenC,KAAkD;EAClE,IAAAoC,SAAA,GAAYjB,cAAA,CAAe,eAAe;EAGhD,IAAInB,KAAA,KAAU,IAAM;IAClBF,yBAAA,GAA4BC,aAAc;MACxCsC,UAAY;MACZvB,OAAS;MACTJ,MAAQ;IACV,CAAC;IACM,OAAAZ,yBAAA;EACT;EACYmC,WAAA,CAAAjB,QAAA,CAASsB,IAAM,EAAAF,SAAA,CAAUhB,KAAK;EAE1C,IAAIpB,KAAA,KAAU,KAAO;IAEPiC,WAAA,CAAAjB,QAAA,CAASsB,IAAM,EAAAF,SAAA,CAAUhB,KAAK;IAC1CtB,yBAAA,CAA0B4B,IAAK;IACH5B,yBAAA;IAC5B;EACF;EACA,OAAOC,aAAA,CAAcC,KAAK;AAC5B;AAIM,IAAAuC,aAAmC,GAAAJ,cAAA;AAEzCI,aAAc,CAAAC,OAAA,GAAU,UAAC5B,GAAa;EAEhCA,GAAA,CAAA6B,MAAA,CAAOC,gBAAA,CAAiBC,QAAW,GAAAR,cAAA;AACzC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}