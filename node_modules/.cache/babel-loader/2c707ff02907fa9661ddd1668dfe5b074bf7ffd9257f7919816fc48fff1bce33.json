{"ast":null,"code":"/**\n * tdesign v1.9.3\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _slicedToArray } from '../../_chunks/dep-a71c8f5b.mjs';\nimport '../adapt.mjs';\nimport { getNode, pathMatchClass } from '../util.mjs';\nimport { usePrefixClass } from '../../hooks/useConfig.mjs';\nimport '../../_chunks/dep-0e21c401.mjs';\nimport 'vue';\nimport '../../utils/withInstall.mjs';\nimport '../../hooks/useVModel.mjs';\nimport '../../_chunks/dep-1c9d9f8d.mjs';\nimport '../../_chunks/dep-437d10c6.mjs';\nimport '../../_chunks/dep-28a28c00.mjs';\nimport '../../_chunks/dep-003c9b00.mjs';\nimport '../../_chunks/dep-6ad32365.mjs';\nimport '../../_chunks/dep-d33c5d88.mjs';\nimport '../../_chunks/dep-10c900d8.mjs';\nimport '../../_chunks/dep-1c5d24dd.mjs';\nimport '../../_chunks/dep-e98ea432.mjs';\nimport '../../_chunks/dep-75628739.mjs';\nimport '../../hooks/useDefaultValue.mjs';\nimport 'tdesign-icons-vue-next';\nimport '../../checkbox/index.mjs';\nimport '../../checkbox/checkbox.mjs';\nimport '../../_chunks/dep-a5dfe884.mjs';\nimport '../../checkbox/props.mjs';\nimport '../../hooks/useRipple.mjs';\nimport '../../hooks/useKeepAnimation.mjs';\nimport '../../_chunks/dep-0223e29d.mjs';\nimport '../../_chunks/dep-c31faaef.mjs';\nimport '../../_chunks/dep-5f15268c.mjs';\nimport '../../_chunks/dep-c70e40ae.mjs';\nimport '../../_chunks/dep-6e7655db.mjs';\nimport '../../_chunks/dep-62ad5a36.mjs';\nimport '../../_chunks/dep-f76ec896.mjs';\nimport '../../_chunks/dep-4382b808.mjs';\nimport '../../_chunks/dep-0894e3ae.mjs';\nimport '../../_chunks/dep-0ced8e2e.mjs';\nimport '../../_chunks/dep-fb9941c5.mjs';\nimport '../../_chunks/dep-1494b54a.mjs';\nimport '../../_chunks/dep-0e5b2b76.mjs';\nimport '../../_chunks/dep-f3a27c4c.mjs';\nimport '../../_chunks/dep-e3204123.mjs';\nimport '../../_chunks/dep-b6946d89.mjs';\nimport '../../_chunks/dep-3d61d8a6.mjs';\nimport '../../_chunks/dep-88c02450.mjs';\nimport '../../_chunks/dep-f7067d3d.mjs';\nimport '../../_chunks/dep-cd1b7f96.mjs';\nimport '../../_chunks/dep-eea784eb.mjs';\nimport '../../_common/js/global-config/default-config.mjs';\nimport '../../_common/js/global-config/locale/zh_CN.mjs';\nimport '../../_chunks/dep-0c808c2e.mjs';\nimport '../../_chunks/dep-4c103c66.mjs';\nimport '../../config-provider/useConfig.mjs';\nimport '../../_chunks/dep-db7324ec.mjs';\nimport '../../_chunks/dep-d090226f.mjs';\nimport '../../_chunks/dep-6ea85de8.mjs';\nimport '../../_chunks/dep-92ce9c6c.mjs';\nimport '../../_chunks/dep-3b84887f.mjs';\nimport '../../_chunks/dep-5d7be5c6.mjs';\nimport '../../config-provider/type.mjs';\nimport '../../utils/set-style.mjs';\nimport '../../hooks/tnode.mjs';\nimport '../../_chunks/dep-190cc0b3.mjs';\nimport '../../_chunks/dep-29a308fc.mjs';\nimport '../../_chunks/dep-18af437d.mjs';\nimport '../../utils/render-tnode.mjs';\nimport '../../_chunks/dep-bc75f95c.mjs';\nimport '../../checkbox/constants.mjs';\nimport '../../checkbox/hooks/useCheckboxLazyLoad.mjs';\nimport '../../_common/js/utils/observe.mjs';\nimport '../../checkbox/hooks/useKeyboardEvent.mjs';\nimport '../../_common/js/common.mjs';\nimport '../../hooks/useDisabled.mjs';\nimport '../../_chunks/dep-36f0e4f4.mjs';\nimport '../../checkbox/group.mjs';\nimport '../../_chunks/dep-4d2c39b6.mjs';\nimport '../../_chunks/dep-69da1a80.mjs';\nimport '../../_chunks/dep-017fc8db.mjs';\nimport '../../_chunks/dep-2f0b4a52.mjs';\nimport '../../_chunks/dep-3c3faac3.mjs';\nimport '../../checkbox/checkbox-group-props.mjs';\nimport '../../hooks/slot.mjs';\nimport './style/css.mjs';\nimport '../../checkbox/type.mjs';\nimport '../../loading/index.mjs';\nimport '../../_chunks/dep-c4a2d318.mjs';\nimport '../../_chunks/dep-143154a5.mjs';\nimport '../../_chunks/dep-69610219.mjs';\nimport '../../_chunks/dep-04ba5b59.mjs';\nimport '../../_chunks/dep-05b564d9.mjs';\nimport '../../_chunks/dep-f41eb5b9.mjs';\nimport '../../_chunks/dep-8cc70cb2.mjs';\nimport '../../loading/plugin.mjs';\nimport '../../loading/loading.mjs';\nimport '../../loading/icon/gradient.mjs';\nimport '../../_common/js/loading/circle-adapter.mjs';\nimport '../../_common/js/utils/set-style.mjs';\nimport '../../_common/js/utils/helper.mjs';\nimport '../../_chunks/dep-8325f53f.mjs';\nimport '../../_chunks/dep-b20328d2.mjs';\nimport '../../_chunks/dep-ae66bf73.mjs';\nimport '../../utils/dom.mjs';\nimport '../../utils/easing.mjs';\nimport '../../loading/props.mjs';\nimport '../../hooks/useTeleport.mjs';\nimport '../../loading/type.mjs';\nimport '../../hooks/useGlobalIcon.mjs';\nimport '../../hooks/useLazyLoad.mjs';\nimport '../../hooks/useVirtualScrollNew.mjs';\nimport '../../hooks/useResizeObserver.mjs';\nimport '../../_chunks/dep-1e57b42e.mjs';\nimport '../../_chunks/dep-67dca09a.mjs';\nimport '../../_chunks/dep-8ee0987a.mjs';\nimport '../../_common/js/tree/tree-node.mjs';\nimport '../../_chunks/dep-009e46c9.mjs';\nimport '../../_chunks/dep-e7c4d7b2.mjs';\nimport '../../_chunks/dep-c9bc2340.mjs';\nimport '../../_chunks/dep-83d6a01b.mjs';\nimport '../../_common/js/tree/tree-node-model.mjs';\nimport '../../_chunks/dep-8bcdb054.mjs';\nimport '../../_chunks/dep-dd2681d3.mjs';\nimport '../../_chunks/dep-e56cdb74.mjs';\nimport '../../_common/js/log/log.mjs';\nimport '../../_common/js/log/index.mjs';\nfunction useTreeAction(state) {\n  var treeState = state;\n  var store = treeState.store;\n  var componentName = usePrefixClass(\"tree\").value;\n  var _state$vmValue = _slicedToArray(state.vmValue, 2),\n    tValue = _state$vmValue[0],\n    setTValue = _state$vmValue[1];\n  var _state$vmActived = _slicedToArray(state.vmActived, 2),\n    tActived = _state$vmActived[0],\n    setTActived = _state$vmActived[1];\n  var _state$vmExpanded = _slicedToArray(state.vmExpanded, 2),\n    tExpanded = _state$vmExpanded[0],\n    setTExpanded = _state$vmExpanded[1];\n  var setExpanded = function setExpanded(item, isExpanded) {\n    var node = getNode(store, item);\n    var mouseEvent = treeState.mouseEvent;\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: \"setItem\"\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = \"node-click\";\n      var target = mouseEvent.target;\n      var currentTarget = mouseEvent.currentTarget;\n      if (pathMatchClass(\"\".concat(componentName, \"__icon\"), target, currentTarget)) {\n        evtCtx.trigger = \"icon-click\";\n      }\n    }\n    var expanded = node.setExpanded(isExpanded, {\n      directly: true\n    });\n    setTExpanded(expanded, evtCtx);\n    if (evtCtx.trigger !== \"setItem\") {\n      store.replaceExpanded(tExpanded.value || []);\n    }\n    return expanded;\n  };\n  var toggleExpanded = function toggleExpanded(item) {\n    var node = getNode(store, item);\n    return setExpanded(node, !node.isExpanded());\n  };\n  var setActived = function setActived(item, isActived) {\n    var node = getNode(store, item);\n    var mouseEvent = treeState.mouseEvent;\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: \"setItem\"\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = \"node-click\";\n    }\n    var actived = node.setActived(isActived, {\n      isAction: evtCtx.trigger === \"node-click\",\n      directly: true\n    });\n    setTActived(actived, evtCtx);\n    if (evtCtx.trigger !== \"setItem\") {\n      store.replaceActived(tActived.value || []);\n    }\n    return actived;\n  };\n  var toggleActived = function toggleActived(item) {\n    var node = getNode(store, item);\n    return setActived(node, !node.isActived());\n  };\n  var setChecked = function setChecked(item, isChecked, ctx) {\n    var node = getNode(store, item);\n    var mouseEvent = ctx === null || ctx === void 0 ? void 0 : ctx.e;\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: \"setItem\"\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = \"node-click\";\n    }\n    var checked = node.setChecked(isChecked, {\n      isAction: evtCtx.trigger === \"node-click\",\n      directly: true\n    });\n    setTValue(checked, evtCtx);\n    if (evtCtx.trigger !== \"setItem\") {\n      store.replaceChecked(tValue.value || []);\n    }\n    return checked;\n  };\n  var toggleChecked = function toggleChecked(item, ctx) {\n    var node = getNode(store, item);\n    if (node.isIndeterminate()) {\n      var expectState = node.hasEnableUnCheckedChild();\n      return setChecked(node, expectState, ctx);\n    }\n    return setChecked(node, !node.isChecked(), ctx);\n  };\n  return {\n    setExpanded: setExpanded,\n    toggleExpanded: toggleExpanded,\n    setActived: setActived,\n    toggleActived: toggleActived,\n    setChecked: setChecked,\n    toggleChecked: toggleChecked\n  };\n}\nexport { useTreeAction as default };","map":{"version":3,"names":["useTreeAction","state","treeState","store","componentName","usePrefixClass","value","_state$vmValue","_slicedToArray","vmValue","tValue","setTValue","_state$vmActived","vmActived","tActived","setTActived","_state$vmExpanded","vmExpanded","tExpanded","setTExpanded","setExpanded","item","isExpanded","node","getNode","mouseEvent","evtCtx","getModel","e","trigger","target","currentTarget","pathMatchClass","concat","expanded","directly","replaceExpanded","toggleExpanded","setActived","isActived","actived","isAction","replaceActived","toggleActived","setChecked","isChecked","ctx","checked","replaceChecked","toggleChecked","isIndeterminate","expectState","hasEnableUnCheckedChild"],"sources":["../../../src/tree/hooks/useTreeAction.ts"],"sourcesContent":["import { usePrefixClass } from '../adapt';\nimport {\n  TreeNodeValue,\n  TypeTreeState,\n  TypeTargetNode,\n  TypeExpandEventContext,\n  TypeActiveEventContext,\n  TypeChangeEventContext,\n} from '../tree-types';\nimport { getNode, pathMatchClass } from '../util';\n\n// tree 组件节点状态设置\nexport default function useTreeAction(state: TypeTreeState) {\n  const treeState = state;\n  const { store } = treeState;\n  const componentName = usePrefixClass('tree').value;\n\n  const [tValue, setTValue] = state.vmValue;\n  const [tActived, setTActived] = state.vmActived;\n  const [tExpanded, setTExpanded] = state.vmExpanded;\n\n  const setExpanded = (item: TypeTargetNode, isExpanded: boolean): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    const mouseEvent = treeState.mouseEvent as MouseEvent;\n    const evtCtx: TypeExpandEventContext = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: 'setItem',\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = 'node-click';\n      const target = mouseEvent.target as HTMLElement;\n      const currentTarget = mouseEvent.currentTarget as HTMLElement;\n      if (pathMatchClass(`${componentName}__icon`, target, currentTarget)) {\n        evtCtx.trigger = 'icon-click';\n      }\n    }\n    const expanded = node.setExpanded(isExpanded, {\n      directly: true,\n    });\n    setTExpanded(expanded, evtCtx);\n    if (evtCtx.trigger !== 'setItem') {\n      store.replaceExpanded((tExpanded.value || []) as TreeNodeValue[]);\n    }\n    return expanded;\n  };\n\n  const toggleExpanded = (item: TypeTargetNode): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    return setExpanded(node, !node.isExpanded());\n  };\n\n  const setActived = (item: TypeTargetNode, isActived: boolean) => {\n    const node = getNode(store, item);\n    const mouseEvent = treeState.mouseEvent as MouseEvent;\n    const evtCtx: TypeActiveEventContext = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: 'setItem',\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = 'node-click';\n    }\n    const actived = node.setActived(isActived, {\n      isAction: evtCtx.trigger === 'node-click',\n      directly: true,\n    });\n    setTActived(actived, evtCtx);\n    if (evtCtx.trigger !== 'setItem') {\n      store.replaceActived((tActived.value || []) as TreeNodeValue[]);\n    }\n    return actived;\n  };\n\n  const toggleActived = (item: TypeTargetNode): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    return setActived(node, !node.isActived());\n  };\n\n  const setChecked = (item: TypeTargetNode, isChecked: boolean, ctx: { e: Event }): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    const mouseEvent = ctx?.e as MouseEvent;\n    const evtCtx: TypeChangeEventContext = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: 'setItem',\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = 'node-click';\n    }\n    const checked = node.setChecked(isChecked, {\n      isAction: evtCtx.trigger === 'node-click',\n      directly: true,\n    });\n    setTValue(checked, evtCtx);\n    // 这是针对受控执行的操作，如果 props.value 未变更，则执行还原操作\n    if (evtCtx.trigger !== 'setItem') {\n      store.replaceChecked((tValue.value || []) as TreeNodeValue[]);\n    }\n    return checked;\n  };\n\n  const toggleChecked = (item: TypeTargetNode, ctx: { e: Event }): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    if (node.isIndeterminate()) {\n      const expectState = node.hasEnableUnCheckedChild();\n      return setChecked(node, expectState, ctx);\n    }\n    return setChecked(node, !node.isChecked(), ctx);\n  };\n\n  return {\n    setExpanded,\n    toggleExpanded,\n    setActived,\n    toggleActived,\n    setChecked,\n    toggleChecked,\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}