{"ast":null,"code":"/**\n * tdesign v1.9.3\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { reactive, watch } from 'vue';\nimport { d as dayjs } from '../../_chunks/dep-0c808c2e.mjs';\nimport '../../hooks/useConfig.mjs';\nimport { COMPONENT_NAME } from '../const.mjs';\nimport { createDefaultCurDate } from '../utils.mjs';\nimport { i as isArray_1 } from '../../_chunks/dep-10c900d8.mjs';\nimport { useConfig } from '../../config-provider/useConfig.mjs';\nimport '../../_chunks/dep-d33c5d88.mjs';\nimport '../../_chunks/dep-437d10c6.mjs';\nimport '../../_chunks/dep-6e7655db.mjs';\nimport '../../_chunks/dep-6ad32365.mjs';\nimport '../../_chunks/dep-62ad5a36.mjs';\nimport '../../_chunks/dep-f76ec896.mjs';\nimport '../../_chunks/dep-db7324ec.mjs';\nimport '../../_chunks/dep-d090226f.mjs';\nimport '../../_chunks/dep-c31faaef.mjs';\nimport '../../_chunks/dep-5f15268c.mjs';\nimport '../../_chunks/dep-c70e40ae.mjs';\nimport '../../_chunks/dep-4382b808.mjs';\nimport '../../_chunks/dep-0894e3ae.mjs';\nimport '../../_chunks/dep-0ced8e2e.mjs';\nimport '../../_chunks/dep-fb9941c5.mjs';\nimport '../../_chunks/dep-75628739.mjs';\nimport '../../_chunks/dep-1494b54a.mjs';\nimport '../../_chunks/dep-0e5b2b76.mjs';\nimport '../../_chunks/dep-f3a27c4c.mjs';\nimport '../../_chunks/dep-e3204123.mjs';\nimport '../../_chunks/dep-1c5d24dd.mjs';\nimport '../../_chunks/dep-b6946d89.mjs';\nimport '../../_chunks/dep-6ea85de8.mjs';\nimport '../../_chunks/dep-92ce9c6c.mjs';\nimport '../../_chunks/dep-3b84887f.mjs';\nimport '../../_chunks/dep-5d7be5c6.mjs';\nimport '../../_chunks/dep-0223e29d.mjs';\nimport '../../_chunks/dep-3d61d8a6.mjs';\nimport '../../_chunks/dep-88c02450.mjs';\nimport '../../_chunks/dep-f7067d3d.mjs';\nimport '../../_chunks/dep-cd1b7f96.mjs';\nimport '../../_chunks/dep-eea784eb.mjs';\nimport '../../_common/js/global-config/default-config.mjs';\nimport '../../_common/js/global-config/locale/zh_CN.mjs';\nimport '../../_chunks/dep-4c103c66.mjs';\nimport '../../config-provider/type.mjs';\nfunction useState(props) {\n  var _useConfig = useConfig(COMPONENT_NAME),\n    globalConfig = _useConfig.globalConfig;\n  var state = reactive({\n    realFirstDayOfWeek: 1,\n    curDate: null,\n    curDateList: [],\n    curSelectedYear: null,\n    curSelectedMonth: null,\n    curSelectedMode: null,\n    isShowWeekend: true,\n    controlSize: \"medium\"\n  });\n  function toToday() {\n    var curDate = createDefaultCurDate();\n    state.curDate = curDate;\n    state.curSelectedYear = curDate.year();\n    state.curSelectedMonth = parseInt(curDate.format(\"M\"), 10);\n  }\n  function setCurSelectedYear(year) {\n    var curSelectedYear = year ? parseInt(\"\".concat(year), 10) : createDefaultCurDate().year();\n    if (!isNaN(curSelectedYear) && curSelectedYear > 0) {\n      state.curSelectedYear = curSelectedYear;\n    }\n  }\n  function setCurSelectedMonth(month) {\n    var curSelectedMonth = month ? parseInt(\"\".concat(month), 10) : parseInt(createDefaultCurDate().format(\"M\"), 10);\n    if (!isNaN(curSelectedMonth) && curSelectedMonth > 0 && curSelectedMonth <= 12) {\n      state.curSelectedMonth = curSelectedMonth;\n    }\n  }\n  function setCurrentDate(value) {\n    if (isArray_1(value)) {\n      state.curDate = value && value.length ? dayjs(value[0]) : createDefaultCurDate();\n    } else {\n      state.curDate = value ? dayjs(value) : createDefaultCurDate();\n    }\n  }\n  function setCurrentDateList(value) {\n    if (isArray_1(value)) {\n      state.curDateList = value && value.length ? value.map(function (item) {\n        return dayjs(item);\n      }) : [createDefaultCurDate()];\n    } else {\n      state.curDateList = value ? [dayjs(value)] : [createDefaultCurDate()];\n    }\n  }\n  function checkDayVisible(day) {\n    var re = true;\n    if (!state.isShowWeekend) {\n      re = day !== 6 && day !== 7;\n    }\n    return re;\n  }\n  watch(function () {\n    return props.firstDayOfWeek;\n  }, function () {\n    var _ref, _props$firstDayOfWeek;\n    state.realFirstDayOfWeek = (_ref = (_props$firstDayOfWeek = props.firstDayOfWeek) !== null && _props$firstDayOfWeek !== void 0 ? _props$firstDayOfWeek : globalConfig.value.firstDayOfWeek) !== null && _ref !== void 0 ? _ref : 1;\n  }, {\n    immediate: true\n  });\n  watch(function () {\n    return props.value;\n  }, function (v) {\n    if (props.multiple) {\n      setCurrentDateList(v);\n    } else {\n      setCurrentDate(v);\n    }\n  }, {\n    immediate: true\n  });\n  watch(function () {\n    return props.year;\n  }, function (v) {\n    setCurSelectedYear(v);\n  }, {\n    immediate: true\n  });\n  watch(function () {\n    return props.month;\n  }, function (v) {\n    setCurSelectedMonth(v);\n  }, {\n    immediate: true\n  });\n  watch(function () {\n    return props.isShowWeekendDefault;\n  }, function (v) {\n    state.isShowWeekend = v;\n  }, {\n    immediate: true\n  });\n  watch(function () {\n    return props.mode;\n  }, function (v) {\n    state.curSelectedMode = v;\n  }, {\n    immediate: true\n  });\n  watch(function () {\n    return props.theme;\n  }, function (v) {\n    if (v === \"card\") state.controlSize = \"small\";\n    if (v === \"full\") state.controlSize = \"medium\";\n  }, {\n    immediate: true\n  });\n  return {\n    state: state,\n    toToday: toToday,\n    checkDayVisible: checkDayVisible\n  };\n}\nexport { useState };","map":{"version":3,"names":["useState","props","_useConfig","useConfig","COMPONENT_NAME","globalConfig","state","reactive","realFirstDayOfWeek","curDate","curDateList","curSelectedYear","curSelectedMonth","curSelectedMode","isShowWeekend","controlSize","toToday","createDefaultCurDate","year","parseInt","format","setCurSelectedYear","concat","isNaN","setCurSelectedMonth","month","setCurrentDate","value","isArray_1","length","dayjs","setCurrentDateList","map","item","checkDayVisible","day","re","watch","firstDayOfWeek","_ref","_props$firstDayOfWeek","immediate","v","multiple","isShowWeekendDefault","mode","theme"],"sources":["../../../src/calendar/hook/useState.ts"],"sourcesContent":["import { reactive, watch } from 'vue';\nimport dayjs from 'dayjs';\n\nimport { useConfig } from '../../hooks/useConfig';\nimport { COMPONENT_NAME } from '../const';\nimport { createDefaultCurDate } from '../utils';\nimport { TdCalendarProps } from '../type';\nimport { CalendarState } from '../interface';\nimport isArray from 'lodash/isArray';\n\nexport function useState(props: TdCalendarProps) {\n  const { globalConfig } = useConfig(COMPONENT_NAME);\n\n  const state = reactive<CalendarState>({\n    realFirstDayOfWeek: 1,\n    curDate: null,\n    curDateList: [],\n    curSelectedYear: null,\n    curSelectedMonth: null,\n    curSelectedMode: null,\n    isShowWeekend: true,\n    controlSize: 'medium',\n  });\n\n  function toToday() {\n    const curDate = createDefaultCurDate();\n    state.curDate = curDate;\n    state.curSelectedYear = curDate.year();\n    state.curSelectedMonth = parseInt(curDate.format('M'), 10);\n  }\n\n  function setCurSelectedYear(year?: TdCalendarProps['year']) {\n    const curSelectedYear = year ? parseInt(`${year}`, 10) : createDefaultCurDate().year();\n    if (!isNaN(curSelectedYear) && curSelectedYear > 0) {\n      state.curSelectedYear = curSelectedYear;\n    }\n  }\n\n  function setCurSelectedMonth(month?: TdCalendarProps['month']) {\n    const curSelectedMonth = month ? parseInt(`${month}`, 10) : parseInt(createDefaultCurDate().format('M'), 10);\n    if (!isNaN(curSelectedMonth) && curSelectedMonth > 0 && curSelectedMonth <= 12) {\n      state.curSelectedMonth = curSelectedMonth;\n    }\n  }\n\n  function setCurrentDate(value?: TdCalendarProps['value']): void {\n    if (isArray(value)) {\n      state.curDate = value && value.length ? dayjs(value[0]) : createDefaultCurDate();\n    } else {\n      state.curDate = value ? dayjs(value) : createDefaultCurDate();\n    }\n  }\n\n  function setCurrentDateList(value?: TdCalendarProps['value']): void {\n    if (isArray(value)) {\n      state.curDateList = value && value.length ? value.map((item) => dayjs(item)) : [createDefaultCurDate()];\n    } else {\n      state.curDateList = value ? [dayjs(value)] : [createDefaultCurDate()];\n    }\n  }\n\n  function checkDayVisible(day: number) {\n    let re = true;\n    if (!state.isShowWeekend) {\n      re = day !== 6 && day !== 7;\n    }\n    return re;\n  }\n\n  watch(\n    () => props.firstDayOfWeek,\n    () => {\n      state.realFirstDayOfWeek = props.firstDayOfWeek ?? globalConfig.value.firstDayOfWeek ?? 1;\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.value,\n    (v: TdCalendarProps['value']) => {\n      if (props.multiple) {\n        setCurrentDateList(v);\n      } else {\n        setCurrentDate(v);\n      }\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.year,\n    (v: TdCalendarProps['year']) => {\n      setCurSelectedYear(v);\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.month,\n    (v: TdCalendarProps['month']) => {\n      setCurSelectedMonth(v);\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.isShowWeekendDefault,\n    (v: TdCalendarProps['isShowWeekendDefault']) => {\n      state.isShowWeekend = v;\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.mode,\n    (v: TdCalendarProps['mode']) => {\n      state.curSelectedMode = v;\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.theme,\n    (v: TdCalendarProps['theme']) => {\n      if (v === 'card') state.controlSize = 'small';\n      if (v === 'full') state.controlSize = 'medium';\n    },\n    { immediate: true },\n  );\n  return {\n    state,\n    toToday,\n    checkDayVisible,\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}