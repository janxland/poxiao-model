{"ast":null,"code":"/**\n * tdesign v1.9.3\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { getMark, emitEvent } from '../util.mjs';\nimport useTreeAction from './useTreeAction.mjs';\nimport '../../_chunks/dep-a5dfe884.mjs';\nimport '../../_chunks/dep-d33c5d88.mjs';\nimport '../../_chunks/dep-190cc0b3.mjs';\nimport '../../_chunks/dep-437d10c6.mjs';\nimport '../../_chunks/dep-003c9b00.mjs';\nimport '../../_chunks/dep-6ad32365.mjs';\nimport '../../_chunks/dep-10c900d8.mjs';\nimport '../../_chunks/dep-1c5d24dd.mjs';\nimport '../../_chunks/dep-e98ea432.mjs';\nimport '../../_chunks/dep-75628739.mjs';\nimport '../../_chunks/dep-29a308fc.mjs';\nimport '../../_chunks/dep-18af437d.mjs';\nimport '../../_chunks/dep-28a28c00.mjs';\nimport '../adapt.mjs';\nimport 'vue';\nimport '../../utils/withInstall.mjs';\nimport '../../hooks/useVModel.mjs';\nimport '../../_chunks/dep-1c9d9f8d.mjs';\nimport '../../hooks/useDefaultValue.mjs';\nimport 'tdesign-icons-vue-next';\nimport '../../checkbox/index.mjs';\nimport '../../checkbox/checkbox.mjs';\nimport '../../_chunks/dep-a71c8f5b.mjs';\nimport '../../_chunks/dep-0e21c401.mjs';\nimport '../../checkbox/props.mjs';\nimport '../../hooks/useRipple.mjs';\nimport '../../hooks/useKeepAnimation.mjs';\nimport '../../hooks/useConfig.mjs';\nimport '../../config-provider/useConfig.mjs';\nimport '../../_chunks/dep-6e7655db.mjs';\nimport '../../_chunks/dep-62ad5a36.mjs';\nimport '../../_chunks/dep-f76ec896.mjs';\nimport '../../_chunks/dep-db7324ec.mjs';\nimport '../../_chunks/dep-d090226f.mjs';\nimport '../../_chunks/dep-c31faaef.mjs';\nimport '../../_chunks/dep-5f15268c.mjs';\nimport '../../_chunks/dep-c70e40ae.mjs';\nimport '../../_chunks/dep-4382b808.mjs';\nimport '../../_chunks/dep-0894e3ae.mjs';\nimport '../../_chunks/dep-0ced8e2e.mjs';\nimport '../../_chunks/dep-fb9941c5.mjs';\nimport '../../_chunks/dep-1494b54a.mjs';\nimport '../../_chunks/dep-0e5b2b76.mjs';\nimport '../../_chunks/dep-f3a27c4c.mjs';\nimport '../../_chunks/dep-e3204123.mjs';\nimport '../../_chunks/dep-b6946d89.mjs';\nimport '../../_chunks/dep-6ea85de8.mjs';\nimport '../../_chunks/dep-92ce9c6c.mjs';\nimport '../../_chunks/dep-3b84887f.mjs';\nimport '../../_chunks/dep-5d7be5c6.mjs';\nimport '../../_chunks/dep-0223e29d.mjs';\nimport '../../_chunks/dep-3d61d8a6.mjs';\nimport '../../_chunks/dep-88c02450.mjs';\nimport '../../_chunks/dep-f7067d3d.mjs';\nimport '../../_chunks/dep-cd1b7f96.mjs';\nimport '../../_chunks/dep-eea784eb.mjs';\nimport '../../_common/js/global-config/default-config.mjs';\nimport '../../_common/js/global-config/locale/zh_CN.mjs';\nimport '../../_chunks/dep-0c808c2e.mjs';\nimport '../../_chunks/dep-4c103c66.mjs';\nimport '../../config-provider/type.mjs';\nimport '../../utils/set-style.mjs';\nimport '../../hooks/tnode.mjs';\nimport '../../utils/render-tnode.mjs';\nimport '../../_chunks/dep-bc75f95c.mjs';\nimport '../../checkbox/constants.mjs';\nimport '../../checkbox/hooks/useCheckboxLazyLoad.mjs';\nimport '../../_common/js/utils/observe.mjs';\nimport '../../checkbox/hooks/useKeyboardEvent.mjs';\nimport '../../_common/js/common.mjs';\nimport '../../hooks/useDisabled.mjs';\nimport '../../_chunks/dep-36f0e4f4.mjs';\nimport '../../checkbox/group.mjs';\nimport '../../_chunks/dep-4d2c39b6.mjs';\nimport '../../_chunks/dep-69da1a80.mjs';\nimport '../../_chunks/dep-017fc8db.mjs';\nimport '../../_chunks/dep-2f0b4a52.mjs';\nimport '../../_chunks/dep-3c3faac3.mjs';\nimport '../../checkbox/checkbox-group-props.mjs';\nimport '../../hooks/slot.mjs';\nimport './style/css.mjs';\nimport '../../checkbox/type.mjs';\nimport '../../loading/index.mjs';\nimport '../../_chunks/dep-c4a2d318.mjs';\nimport '../../_chunks/dep-143154a5.mjs';\nimport '../../_chunks/dep-69610219.mjs';\nimport '../../_chunks/dep-04ba5b59.mjs';\nimport '../../_chunks/dep-05b564d9.mjs';\nimport '../../_chunks/dep-f41eb5b9.mjs';\nimport '../../_chunks/dep-8cc70cb2.mjs';\nimport '../../loading/plugin.mjs';\nimport '../../loading/loading.mjs';\nimport '../../loading/icon/gradient.mjs';\nimport '../../_common/js/loading/circle-adapter.mjs';\nimport '../../_common/js/utils/set-style.mjs';\nimport '../../_common/js/utils/helper.mjs';\nimport '../../_chunks/dep-8325f53f.mjs';\nimport '../../_chunks/dep-b20328d2.mjs';\nimport '../../_chunks/dep-ae66bf73.mjs';\nimport '../../utils/dom.mjs';\nimport '../../utils/easing.mjs';\nimport '../../loading/props.mjs';\nimport '../../hooks/useTeleport.mjs';\nimport '../../loading/type.mjs';\nimport '../../hooks/useGlobalIcon.mjs';\nimport '../../hooks/useLazyLoad.mjs';\nimport '../../hooks/useVirtualScrollNew.mjs';\nimport '../../hooks/useResizeObserver.mjs';\nimport '../../_chunks/dep-1e57b42e.mjs';\nimport '../../_chunks/dep-67dca09a.mjs';\nimport '../../_chunks/dep-8ee0987a.mjs';\nimport '../../_common/js/tree/tree-node.mjs';\nimport '../../_chunks/dep-009e46c9.mjs';\nimport '../../_chunks/dep-e7c4d7b2.mjs';\nimport '../../_chunks/dep-c9bc2340.mjs';\nimport '../../_chunks/dep-83d6a01b.mjs';\nimport '../../_common/js/tree/tree-node-model.mjs';\nimport '../../_chunks/dep-8bcdb054.mjs';\nimport '../../_chunks/dep-dd2681d3.mjs';\nimport '../../_chunks/dep-e56cdb74.mjs';\nimport '../../_common/js/log/log.mjs';\nimport '../../_common/js/log/index.mjs';\nfunction useTreeEvents(state) {\n  var treeState = state;\n  var props = treeState.props,\n    context = treeState.context;\n  var _useTreeAction = useTreeAction(state),\n    toggleExpanded = _useTreeAction.toggleExpanded,\n    toggleActived = _useTreeAction.toggleActived,\n    toggleChecked = _useTreeAction.toggleChecked;\n  var handleClick = function handleClick(evtState) {\n    var mouseEvent = evtState.mouseEvent,\n      event = evtState.event,\n      node = evtState.node;\n    if (!node || !mouseEvent) return;\n    treeState.mouseEvent = mouseEvent;\n    var shouldExpand = props.expandOnClickNode;\n    var shouldActive = !props.disabled && !node.disabled && node.isActivable();\n    [\"trigger\", \"ignore\"].forEach(function (markName) {\n      var mark = getMark(markName, event.target, event.currentTarget);\n      var markValue = (mark === null || mark === void 0 ? void 0 : mark.value) || \"\";\n      if (markValue.indexOf(\"expand\") >= 0) {\n        if (markName === \"trigger\") {\n          shouldExpand = true;\n        } else if (markName === \"ignore\") {\n          shouldExpand = false;\n        }\n      }\n      if (markValue.indexOf(\"active\") >= 0) {\n        if (markName === \"ignore\") {\n          shouldActive = false;\n        }\n      }\n    });\n    if (shouldExpand) {\n      toggleExpanded(node);\n    }\n    if (shouldActive) {\n      toggleActived(node);\n    }\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent\n    };\n    emitEvent(props, context, \"click\", evtCtx);\n    treeState.mouseEvent = null;\n  };\n  var handleChange = function handleChange(evtState, ctx) {\n    var disabled = props.disabled;\n    var node = evtState.node;\n    if (!node || disabled || node.disabled || !node.isCheckable()) {\n      return;\n    }\n    toggleChecked(node, ctx);\n  };\n  return {\n    handleChange: handleChange,\n    handleClick: handleClick\n  };\n}\nexport { useTreeEvents as default };","map":{"version":3,"names":["useTreeEvents","state","treeState","props","context","_useTreeAction","useTreeAction","toggleExpanded","toggleActived","toggleChecked","handleClick","evtState","mouseEvent","event","node","shouldExpand","expandOnClickNode","shouldActive","disabled","isActivable","forEach","markName","mark","getMark","target","currentTarget","markValue","value","indexOf","evtCtx","getModel","e","emitEvent","handleChange","ctx","isCheckable"],"sources":["../../../src/tree/hooks/useTreeEvents.ts"],"sourcesContent":["import { TreeProps, TypeTreeState, TypeEventState } from '../tree-types';\nimport { getMark, emitEvent } from '../util';\nimport useTreeAction from './useTreeAction';\n\n// tree 组件一般事件处理\nexport default function useTreeEvents(state: TypeTreeState) {\n  const treeState = state;\n  const { props, context } = treeState;\n  const { toggleExpanded, toggleActived, toggleChecked } = useTreeAction(state);\n\n  const handleClick = (evtState: TypeEventState) => {\n    const { mouseEvent, event, node } = evtState;\n    if (!node || !mouseEvent) return;\n\n    // 用于向内部方法传递事件对象\n    treeState.mouseEvent = mouseEvent;\n\n    let shouldExpand = props.expandOnClickNode;\n    let shouldActive = !props.disabled && !node.disabled && node.isActivable();\n\n    // 给节点添加属性 trigger=\"expand,active\", ignore=\"expand,active\"\n    // 来确认或者屏蔽动作\n    ['trigger', 'ignore'].forEach((markName) => {\n      const mark = getMark(markName, event.target as HTMLElement, event.currentTarget as HTMLElement);\n      const markValue = mark?.value || '';\n      if (markValue.indexOf('expand') >= 0) {\n        // 路径节点包含了 trigger=\"expand\" ignore=\"expand\"\n        if (markName === 'trigger') {\n          shouldExpand = true;\n        } else if (markName === 'ignore') {\n          shouldExpand = false;\n        }\n      }\n      if (markValue.indexOf('active') >= 0) {\n        // 路径节点包含了 trigger=\"active\" ignore=\"active\"\n        if (markName === 'ignore') {\n          shouldActive = false;\n        }\n      }\n    });\n\n    if (shouldExpand) {\n      toggleExpanded(node);\n    }\n\n    if (shouldActive) {\n      toggleActived(node);\n    }\n\n    const evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n    };\n    emitEvent<Parameters<TreeProps['onClick']>>(props, context, 'click', evtCtx);\n\n    treeState.mouseEvent = null;\n  };\n\n  const handleChange = (evtState: TypeEventState, ctx: { e: Event }) => {\n    const { disabled } = props;\n    const { node } = evtState;\n    if (!node || disabled || node.disabled || !node.isCheckable()) {\n      return;\n    }\n    toggleChecked(node, ctx);\n  };\n\n  return {\n    handleChange,\n    handleClick,\n  };\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA,SAAwBA,cAAcC,KAAsB;EAC1D,IAAMC,SAAY,GAAAD,KAAA;EACZ,IAAEE,KAAO,GAAYD,SAAA,CAAnBC,KAAO;IAAAC,OAAA,GAAYF,SAAA,CAAZE,OAAA;EACf,IAAAC,cAAA,GAAyDC,aAAA,CAAcL,KAAK;IAApEM,cAAgB,GAAAF,cAAA,CAAhBE,cAAgB;IAAAC,aAAA,GAAAH,cAAA,CAAAG,aAAA;IAAeC,aAAc,GAAAJ,cAAA,CAAdI,aAAc;EAE/C,IAAAC,WAAA,GAAc,SAAdA,YAAeC,QAA6B;IAChD,IAAQC,UAAA,GAA4BD,QAAA,CAA5BC,UAAA;MAAYC,KAAO,GAASF,QAAA,CAAhBE,KAAO;MAAAC,IAAA,GAASH,QAAA,CAATG,IAAA;IACvB,KAACA,IAAA,IAAQ,CAACF,UAAA,EAAY;IAG1BV,SAAA,CAAUU,UAAa,GAAAA,UAAA;IAEvB,IAAIG,YAAA,GAAeZ,KAAM,CAAAa,iBAAA;IACrB,IAAAC,YAAA,GAAe,CAACd,KAAM,CAAAe,QAAA,IAAY,CAACJ,IAAK,CAAAI,QAAA,IAAYJ,IAAA,CAAKK,WAAY;IAIzE,CAAC,SAAW,UAAQ,CAAE,CAAAC,OAAA,CAAQ,UAACC,QAAa;MAC1C,IAAMC,IAAA,GAAOC,OAAQ,CAAAF,QAAA,EAAUR,KAAM,CAAAW,MAAA,EAAuBX,KAAA,CAAMY,aAA4B;MACxF,IAAAC,SAAA,GAAY,CAAAJ,IAAA,aAAAA,IAAA,uBAAAA,IAAA,CAAMK,KAAS;MACjC,IAAID,SAAU,CAAAE,OAAA,CAAQ,QAAQ,KAAK,CAAG;QAEpC,IAAIP,QAAA,KAAa,SAAW;UACXN,YAAA;QACjB,WAAWM,QAAA,KAAa,QAAU;UACjBN,YAAA;QACjB;MACF;MACA,IAAIW,SAAU,CAAAE,OAAA,CAAQ,QAAQ,KAAK,CAAG;QAEpC,IAAIP,QAAA,KAAa,QAAU;UACVJ,YAAA;QACjB;MACF;IACF,CAAC;IAED,IAAIF,YAAc;MAChBR,cAAA,CAAeO,IAAI;IACrB;IAEA,IAAIG,YAAc;MAChBT,aAAA,CAAcM,IAAI;IACpB;IAEA,IAAMe,MAAS;MACbf,IAAA,EAAMA,IAAA,CAAKgB,QAAS;MACpBC,CAAG,EAAAnB;KACL;IAC4CoB,SAAA,CAAA7B,KAAA,EAAOC,OAAS,WAASyB,MAAM;IAE3E3B,SAAA,CAAUU,UAAa;GACzB;EAEM,IAAAqB,YAAA,GAAe,SAAfA,aAAgBtB,QAAA,EAA0BuB,GAAsB;IAC9D,IAAEhB,QAAA,GAAaf,KAAA,CAAbe,QAAA;IACF,IAAEJ,IAAA,GAASH,QAAA,CAATG,IAAA;IACJ,KAACA,IAAA,IAAQI,QAAY,IAAAJ,IAAA,CAAKI,QAAA,IAAY,CAACJ,IAAA,CAAKqB,WAAA,EAAe;MAC7D;IACF;IACA1B,aAAA,CAAcK,IAAA,EAAMoB,GAAG;GACzB;EAEO;IACLD,YAAA,EAAAA,YAAA;IACAvB,WAAA,EAAAA;GACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}