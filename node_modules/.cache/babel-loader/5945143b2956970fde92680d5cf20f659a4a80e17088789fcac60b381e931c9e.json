{"ast":null,"code":"/**\n * tdesign v1.9.0\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { getMark, emitEvent } from '../util.mjs';\nimport useTreeAction from './useTreeAction.mjs';\nimport '../../_chunks/dep-7deaa3b9.mjs';\nimport '../../_chunks/dep-8dbc9855.mjs';\nimport '../../_chunks/dep-f8909853.mjs';\nimport '../../_chunks/dep-cb814df4.mjs';\nimport '../../_chunks/dep-67e59a11.mjs';\nimport '../../_chunks/dep-cd533155.mjs';\nimport '../../_chunks/dep-ab439391.mjs';\nimport '../../_chunks/dep-60d62610.mjs';\nimport '../../_chunks/dep-10024af3.mjs';\nimport '../../_chunks/dep-2adf18a2.mjs';\nimport '../../_chunks/dep-d00e2e04.mjs';\nimport '../../_chunks/dep-ec2f76cc.mjs';\nimport '../../_chunks/dep-96484611.mjs';\nimport '../adapt.mjs';\nimport 'vue';\nimport '../../utils/withInstall.mjs';\nimport '../../hooks/useVModel.mjs';\nimport '../../_chunks/dep-bd7cd061.mjs';\nimport '../../hooks/useDefaultValue.mjs';\nimport 'tdesign-icons-vue-next';\nimport '../../checkbox/index.mjs';\nimport '../../checkbox/checkbox.mjs';\nimport '../../_chunks/dep-b089fa1f.mjs';\nimport '../../_chunks/dep-8e411f1c.mjs';\nimport '../../checkbox/props.mjs';\nimport '../../hooks/useRipple.mjs';\nimport '../../hooks/useKeepAnimation.mjs';\nimport '../../hooks/useConfig.mjs';\nimport '../../config-provider/useConfig.mjs';\nimport '../../_chunks/dep-66473aa9.mjs';\nimport '../../_chunks/dep-715774e0.mjs';\nimport '../../_chunks/dep-5a5a1764.mjs';\nimport '../../_chunks/dep-37e3e644.mjs';\nimport '../../_chunks/dep-31dc0415.mjs';\nimport '../../_chunks/dep-e5142249.mjs';\nimport '../../_chunks/dep-c4f80cb4.mjs';\nimport '../../_chunks/dep-996b4900.mjs';\nimport '../../_chunks/dep-3108c312.mjs';\nimport '../../_chunks/dep-93498383.mjs';\nimport '../../_chunks/dep-36582a92.mjs';\nimport '../../_chunks/dep-a2db6df1.mjs';\nimport '../../_chunks/dep-0f89a1dd.mjs';\nimport '../../_chunks/dep-d4da440a.mjs';\nimport '../../_chunks/dep-013382c3.mjs';\nimport '../../_chunks/dep-ca764006.mjs';\nimport '../../_chunks/dep-2ee9d497.mjs';\nimport '../../_chunks/dep-c545db54.mjs';\nimport '../../_chunks/dep-3f15cb30.mjs';\nimport '../../_chunks/dep-fd2b6c64.mjs';\nimport '../../_chunks/dep-30b3f256.mjs';\nimport '../../_chunks/dep-b3734774.mjs';\nimport '../../_chunks/dep-a4a3ac25.mjs';\nimport '../../_chunks/dep-6861d388.mjs';\nimport '../../_chunks/dep-396d852b.mjs';\nimport '../../_chunks/dep-8a3fd140.mjs';\nimport '../../_chunks/dep-5db0da5c.mjs';\nimport '../../_common/js/global-config/default-config.mjs';\nimport '../../_common/js/global-config/locale/zh_CN.mjs';\nimport '../../_chunks/dep-bf19d9ba.mjs';\nimport '../../_chunks/dep-6963a882.mjs';\nimport '../../config-provider/type.mjs';\nimport '../../utils/set-style.mjs';\nimport '../../hooks/tnode.mjs';\nimport '../../utils/render-tnode.mjs';\nimport '../../_chunks/dep-60ee423b.mjs';\nimport '../../checkbox/constants.mjs';\nimport '../../checkbox/hooks/useCheckboxLazyLoad.mjs';\nimport '../../_common/js/utils/observe.mjs';\nimport '../../checkbox/hooks/useKeyboardEvent.mjs';\nimport '../../_common/js/common.mjs';\nimport '../../hooks/useDisabled.mjs';\nimport '../../_chunks/dep-03dfef8f.mjs';\nimport '../../checkbox/group.mjs';\nimport '../../_chunks/dep-b15588b0.mjs';\nimport '../../_chunks/dep-c628112b.mjs';\nimport '../../_chunks/dep-1aab510a.mjs';\nimport '../../_chunks/dep-931fe368.mjs';\nimport '../../_chunks/dep-ac561548.mjs';\nimport '../../checkbox/checkbox-group-props.mjs';\nimport '../../hooks/slot.mjs';\nimport './style/css.mjs';\nimport '../../checkbox/type.mjs';\nimport '../../loading/index.mjs';\nimport '../../_chunks/dep-503b7515.mjs';\nimport '../../_chunks/dep-e32ac680.mjs';\nimport '../../_chunks/dep-230c1b47.mjs';\nimport '../../_chunks/dep-cedc2818.mjs';\nimport '../../_chunks/dep-8dae3bca.mjs';\nimport '../../_chunks/dep-41db3bc9.mjs';\nimport '../../_chunks/dep-da57e0cf.mjs';\nimport '../../loading/plugin.mjs';\nimport '../../loading/loading.mjs';\nimport '../../loading/icon/gradient.mjs';\nimport '../../_common/js/loading/circle-adapter.mjs';\nimport '../../_common/js/utils/set-style.mjs';\nimport '../../_common/js/utils/helper.mjs';\nimport '../../_chunks/dep-807e1747.mjs';\nimport '../../_chunks/dep-413fbf03.mjs';\nimport '../../_chunks/dep-0e4de31a.mjs';\nimport '../../utils/dom.mjs';\nimport '../../utils/easing.mjs';\nimport '../../loading/props.mjs';\nimport '../../hooks/useTeleport.mjs';\nimport '../../loading/type.mjs';\nimport '../../hooks/useGlobalIcon.mjs';\nimport '../../hooks/useLazyLoad.mjs';\nimport '../../hooks/useVirtualScrollNew.mjs';\nimport '../../hooks/useResizeObserver.mjs';\nimport '../../_chunks/dep-cede586b.mjs';\nimport '../../_chunks/dep-665d45b4.mjs';\nimport '../../_chunks/dep-27be073b.mjs';\nimport '../../_common/js/tree/tree-node.mjs';\nimport '../../_chunks/dep-f14cdac0.mjs';\nimport '../../_chunks/dep-12bcaf4a.mjs';\nimport '../../_chunks/dep-d0177ed3.mjs';\nimport '../../_chunks/dep-cd711cee.mjs';\nimport '../../_common/js/tree/tree-node-model.mjs';\nimport '../../_chunks/dep-8fdb2da0.mjs';\nimport '../../_chunks/dep-d7c36095.mjs';\nimport '../../_chunks/dep-4481f632.mjs';\nimport '../../_common/js/log/log.mjs';\nimport '../../_common/js/log/index.mjs';\nfunction useTreeEvents(state) {\n  var treeState = state;\n  var props = treeState.props,\n    context = treeState.context;\n  var _useTreeAction = useTreeAction(state),\n    toggleExpanded = _useTreeAction.toggleExpanded,\n    toggleActived = _useTreeAction.toggleActived,\n    toggleChecked = _useTreeAction.toggleChecked;\n  var handleClick = function handleClick(evtState) {\n    var mouseEvent = evtState.mouseEvent,\n      event = evtState.event,\n      node = evtState.node;\n    if (!node || !mouseEvent) return;\n    treeState.mouseEvent = mouseEvent;\n    var shouldExpand = props.expandOnClickNode;\n    var shouldActive = !props.disabled && !node.disabled && node.isActivable();\n    [\"trigger\", \"ignore\"].forEach(function (markName) {\n      var mark = getMark(markName, event.target, event.currentTarget);\n      var markValue = (mark === null || mark === void 0 ? void 0 : mark.value) || \"\";\n      if (markValue.indexOf(\"expand\") >= 0) {\n        if (markName === \"trigger\") {\n          shouldExpand = true;\n        } else if (markName === \"ignore\") {\n          shouldExpand = false;\n        }\n      }\n      if (markValue.indexOf(\"active\") >= 0) {\n        if (markName === \"ignore\") {\n          shouldActive = false;\n        }\n      }\n    });\n    if (shouldExpand) {\n      toggleExpanded(node);\n    }\n    if (shouldActive) {\n      toggleActived(node);\n    }\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent\n    };\n    emitEvent(props, context, \"click\", evtCtx);\n    treeState.mouseEvent = null;\n  };\n  var handleChange = function handleChange(evtState, ctx) {\n    var disabled = props.disabled;\n    var node = evtState.node;\n    if (!node || disabled || node.disabled || !node.isCheckable()) {\n      return;\n    }\n    toggleChecked(node, ctx);\n  };\n  return {\n    handleChange: handleChange,\n    handleClick: handleClick\n  };\n}\nexport { useTreeEvents as default };","map":{"version":3,"names":["useTreeEvents","state","treeState","props","context","_useTreeAction","useTreeAction","toggleExpanded","toggleActived","toggleChecked","handleClick","evtState","mouseEvent","event","node","shouldExpand","expandOnClickNode","shouldActive","disabled","isActivable","forEach","markName","mark","getMark","target","currentTarget","markValue","value","indexOf","evtCtx","getModel","e","emitEvent","handleChange","ctx","isCheckable"],"sources":["../../../src/tree/hooks/useTreeEvents.ts"],"sourcesContent":["import { TreeProps, TypeTreeState, TypeEventState } from '../tree-types';\nimport { getMark, emitEvent } from '../util';\nimport useTreeAction from './useTreeAction';\n\n// tree 组件一般事件处理\nexport default function useTreeEvents(state: TypeTreeState) {\n  const treeState = state;\n  const { props, context } = treeState;\n  const { toggleExpanded, toggleActived, toggleChecked } = useTreeAction(state);\n\n  const handleClick = (evtState: TypeEventState) => {\n    const { mouseEvent, event, node } = evtState;\n    if (!node || !mouseEvent) return;\n\n    // 用于向内部方法传递事件对象\n    treeState.mouseEvent = mouseEvent;\n\n    let shouldExpand = props.expandOnClickNode;\n    let shouldActive = !props.disabled && !node.disabled && node.isActivable();\n\n    // 给节点添加属性 trigger=\"expand,active\", ignore=\"expand,active\"\n    // 来确认或者屏蔽动作\n    ['trigger', 'ignore'].forEach((markName) => {\n      const mark = getMark(markName, event.target as HTMLElement, event.currentTarget as HTMLElement);\n      const markValue = mark?.value || '';\n      if (markValue.indexOf('expand') >= 0) {\n        // 路径节点包含了 trigger=\"expand\" ignore=\"expand\"\n        if (markName === 'trigger') {\n          shouldExpand = true;\n        } else if (markName === 'ignore') {\n          shouldExpand = false;\n        }\n      }\n      if (markValue.indexOf('active') >= 0) {\n        // 路径节点包含了 trigger=\"active\" ignore=\"active\"\n        if (markName === 'ignore') {\n          shouldActive = false;\n        }\n      }\n    });\n\n    if (shouldExpand) {\n      toggleExpanded(node);\n    }\n\n    if (shouldActive) {\n      toggleActived(node);\n    }\n\n    const evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n    };\n    emitEvent<Parameters<TreeProps['onClick']>>(props, context, 'click', evtCtx);\n\n    treeState.mouseEvent = null;\n  };\n\n  const handleChange = (evtState: TypeEventState, ctx: { e: Event }) => {\n    const { disabled } = props;\n    const { node } = evtState;\n    if (!node || disabled || node.disabled || !node.isCheckable()) {\n      return;\n    }\n    toggleChecked(node, ctx);\n  };\n\n  return {\n    handleChange,\n    handleClick,\n  };\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA,SAAwBA,cAAcC,KAAsB;EAC1D,IAAMC,SAAY,GAAAD,KAAA;EACZ,IAAEE,KAAO,GAAYD,SAAA,CAAnBC,KAAO;IAAAC,OAAA,GAAYF,SAAA,CAAZE,OAAA;EACf,IAAAC,cAAA,GAAyDC,aAAA,CAAcL,KAAK;IAApEM,cAAgB,GAAAF,cAAA,CAAhBE,cAAgB;IAAAC,aAAA,GAAAH,cAAA,CAAAG,aAAA;IAAeC,aAAc,GAAAJ,cAAA,CAAdI,aAAc;EAE/C,IAAAC,WAAA,GAAc,SAAdA,YAAeC,QAA6B;IAChD,IAAQC,UAAA,GAA4BD,QAAA,CAA5BC,UAAA;MAAYC,KAAO,GAASF,QAAA,CAAhBE,KAAO;MAAAC,IAAA,GAASH,QAAA,CAATG,IAAA;IACvB,KAACA,IAAA,IAAQ,CAACF,UAAA,EAAY;IAG1BV,SAAA,CAAUU,UAAa,GAAAA,UAAA;IAEvB,IAAIG,YAAA,GAAeZ,KAAM,CAAAa,iBAAA;IACrB,IAAAC,YAAA,GAAe,CAACd,KAAM,CAAAe,QAAA,IAAY,CAACJ,IAAK,CAAAI,QAAA,IAAYJ,IAAA,CAAKK,WAAY;IAIzE,CAAC,SAAW,UAAQ,CAAE,CAAAC,OAAA,CAAQ,UAACC,QAAa;MAC1C,IAAMC,IAAA,GAAOC,OAAQ,CAAAF,QAAA,EAAUR,KAAM,CAAAW,MAAA,EAAuBX,KAAA,CAAMY,aAA4B;MACxF,IAAAC,SAAA,GAAY,CAAAJ,IAAA,aAAAA,IAAA,uBAAAA,IAAA,CAAMK,KAAS;MACjC,IAAID,SAAU,CAAAE,OAAA,CAAQ,QAAQ,KAAK,CAAG;QAEpC,IAAIP,QAAA,KAAa,SAAW;UACXN,YAAA;QACjB,WAAWM,QAAA,KAAa,QAAU;UACjBN,YAAA;QACjB;MACF;MACA,IAAIW,SAAU,CAAAE,OAAA,CAAQ,QAAQ,KAAK,CAAG;QAEpC,IAAIP,QAAA,KAAa,QAAU;UACVJ,YAAA;QACjB;MACF;IACF,CAAC;IAED,IAAIF,YAAc;MAChBR,cAAA,CAAeO,IAAI;IACrB;IAEA,IAAIG,YAAc;MAChBT,aAAA,CAAcM,IAAI;IACpB;IAEA,IAAMe,MAAS;MACbf,IAAA,EAAMA,IAAA,CAAKgB,QAAS;MACpBC,CAAG,EAAAnB;KACL;IAC4CoB,SAAA,CAAA7B,KAAA,EAAOC,OAAS,WAASyB,MAAM;IAE3E3B,SAAA,CAAUU,UAAa;GACzB;EAEM,IAAAqB,YAAA,GAAe,SAAfA,aAAgBtB,QAAA,EAA0BuB,GAAsB;IAC9D,IAAEhB,QAAA,GAAaf,KAAA,CAAbe,QAAA;IACF,IAAEJ,IAAA,GAASH,QAAA,CAATG,IAAA;IACJ,KAACA,IAAA,IAAQI,QAAY,IAAAJ,IAAA,CAAKI,QAAA,IAAY,CAACJ,IAAA,CAAKqB,WAAA,EAAe;MAC7D;IACF;IACA1B,aAAA,CAAcK,IAAA,EAAMoB,GAAG;GACzB;EAEO;IACLD,YAAA,EAAAA,YAAA;IACAvB,WAAA,EAAAA;GACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}