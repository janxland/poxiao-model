{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/**\n * tdesign v1.9.0\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _toConsumableArray } from '../_chunks/dep-b15588b0.mjs';\nimport { _ as _defineProperty } from '../_chunks/dep-7deaa3b9.mjs';\nimport { ref, defineComponent, onMounted, nextTick, h, createApp } from 'vue';\nimport _Dialog from './dialog.mjs';\nimport { getAttach } from '../utils/dom.mjs';\nimport { o as omit_1 } from '../_chunks/dep-8fdb2da0.mjs';\nimport '../_chunks/dep-8e411f1c.mjs';\nimport '../_chunks/dep-8dbc9855.mjs';\nimport 'tdesign-icons-vue-next';\nimport './props.mjs';\nimport '../hooks/useGlobalIcon.mjs';\nimport '../hooks/useConfig.mjs';\nimport '../config-provider/useConfig.mjs';\nimport '../_chunks/dep-66473aa9.mjs';\nimport '../_chunks/dep-cb814df4.mjs';\nimport '../_chunks/dep-cd533155.mjs';\nimport '../_chunks/dep-715774e0.mjs';\nimport '../_chunks/dep-5a5a1764.mjs';\nimport '../_chunks/dep-37e3e644.mjs';\nimport '../_chunks/dep-31dc0415.mjs';\nimport '../_chunks/dep-e5142249.mjs';\nimport '../_chunks/dep-c4f80cb4.mjs';\nimport '../_chunks/dep-996b4900.mjs';\nimport '../_chunks/dep-3108c312.mjs';\nimport '../_chunks/dep-93498383.mjs';\nimport '../_chunks/dep-36582a92.mjs';\nimport '../_chunks/dep-a2db6df1.mjs';\nimport '../_chunks/dep-0f89a1dd.mjs';\nimport '../_chunks/dep-2adf18a2.mjs';\nimport '../_chunks/dep-ab439391.mjs';\nimport '../_chunks/dep-60d62610.mjs';\nimport '../_chunks/dep-d4da440a.mjs';\nimport '../_chunks/dep-013382c3.mjs';\nimport '../_chunks/dep-ca764006.mjs';\nimport '../_chunks/dep-2ee9d497.mjs';\nimport '../_chunks/dep-c545db54.mjs';\nimport '../_chunks/dep-3f15cb30.mjs';\nimport '../_chunks/dep-fd2b6c64.mjs';\nimport '../_chunks/dep-30b3f256.mjs';\nimport '../_chunks/dep-b3734774.mjs';\nimport '../_chunks/dep-a4a3ac25.mjs';\nimport '../_chunks/dep-6861d388.mjs';\nimport '../_chunks/dep-396d852b.mjs';\nimport '../_chunks/dep-8a3fd140.mjs';\nimport '../_chunks/dep-5db0da5c.mjs';\nimport '../_common/js/global-config/default-config.mjs';\nimport '../_common/js/global-config/locale/zh_CN.mjs';\nimport '../_chunks/dep-bf19d9ba.mjs';\nimport '../_chunks/dep-6963a882.mjs';\nimport '../config-provider/type.mjs';\nimport './hooks.mjs';\nimport '../hooks/tnode.mjs';\nimport '../_chunks/dep-f8909853.mjs';\nimport '../_chunks/dep-67e59a11.mjs';\nimport '../_chunks/dep-10024af3.mjs';\nimport '../_chunks/dep-d00e2e04.mjs';\nimport '../_chunks/dep-ec2f76cc.mjs';\nimport '../_chunks/dep-96484611.mjs';\nimport '../_chunks/dep-bd7cd061.mjs';\nimport '../utils/render-tnode.mjs';\nimport '../_chunks/dep-60ee423b.mjs';\nimport '../button/index.mjs';\nimport '../button/button.mjs';\nimport '../loading/index.mjs';\nimport '../_chunks/dep-503b7515.mjs';\nimport '../_chunks/dep-e32ac680.mjs';\nimport '../_chunks/dep-1aab510a.mjs';\nimport '../_chunks/dep-230c1b47.mjs';\nimport '../_chunks/dep-cedc2818.mjs';\nimport '../_chunks/dep-8dae3bca.mjs';\nimport '../_chunks/dep-41db3bc9.mjs';\nimport '../_chunks/dep-da57e0cf.mjs';\nimport '../loading/plugin.mjs';\nimport '../loading/loading.mjs';\nimport '../_chunks/dep-b089fa1f.mjs';\nimport '../loading/icon/gradient.mjs';\nimport '../_common/js/loading/circle-adapter.mjs';\nimport '../_common/js/utils/set-style.mjs';\nimport '../_common/js/utils/helper.mjs';\nimport '../_chunks/dep-807e1747.mjs';\nimport '../_chunks/dep-413fbf03.mjs';\nimport '../_chunks/dep-ac561548.mjs';\nimport '../_chunks/dep-0e4de31a.mjs';\nimport '../loading/props.mjs';\nimport '../hooks/useTeleport.mjs';\nimport '../utils/withInstall.mjs';\nimport './style/css.mjs';\nimport '../loading/type.mjs';\nimport '../utils/easing.mjs';\nimport '../button/props.mjs';\nimport '../hooks/useRipple.mjs';\nimport '../hooks/useKeepAnimation.mjs';\nimport '../utils/set-style.mjs';\nimport '../hooks/useDisabled.mjs';\nimport '../_chunks/dep-03dfef8f.mjs';\nimport '../button/type.mjs';\nimport '../hooks/useDestroyOnClose.mjs';\nimport '../_common/js/utils/getScrollbarWidth.mjs';\nimport '../hooks/usePopupManager.mjs';\nimport '../_chunks/dep-12bcaf4a.mjs';\nimport '../_chunks/dep-d7c36095.mjs';\nimport '../_chunks/dep-4481f632.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nvar createDialog = function createDialog(props) {\n  var options = _objectSpread({}, props);\n  var wrapper = document.createElement(\"div\");\n  var visible = ref(false);\n  var className = options.className,\n    style = options.style;\n  var preClassName = className;\n  var updateClassNameStyle = function updateClassNameStyle(className2, style2) {\n    if (className2) {\n      if (preClassName && preClassName !== className2) {\n        var _wrapper$firstElement;\n        (_wrapper$firstElement = wrapper.firstElementChild.classList).remove.apply(_wrapper$firstElement, _toConsumableArray(preClassName.split(\" \").map(function (name) {\n          return name.trim();\n        })));\n      }\n      className2.split(\" \").forEach(function (name) {\n        wrapper.firstElementChild.classList.add(name.trim());\n      });\n    }\n    if (style2) {\n      wrapper.firstElementChild.style.cssText += style2;\n    }\n    preClassName = className2;\n  };\n  var component = defineComponent({\n    setup: function setup(props2, _ref) {\n      var expose = _ref.expose;\n      var dialogOptions = ref(options);\n      onMounted(function () {\n        visible.value = true;\n        document.activeElement.blur();\n        nextTick(function () {\n          updateClassNameStyle(className, style);\n        });\n      });\n      var update = function update(newOptions) {\n        dialogOptions.value = _objectSpread(_objectSpread({}, options), newOptions);\n      };\n      expose({\n        update: update\n      });\n      return function () {\n        var onClose = options.onClose || function () {\n          visible.value = false;\n        };\n        delete options.className;\n        delete options.style;\n        return h(_Dialog, _objectSpread({\n          onClose: onClose,\n          visible: visible.value\n        }, dialogOptions.value));\n      };\n    }\n  });\n  var dialogComponent = createApp(component);\n  var dialog = dialogComponent.mount(wrapper);\n  var container = getAttach(options.attach);\n  if (container) {\n    container.appendChild(wrapper);\n  } else {\n    console.error(\"attach is not exist\");\n  }\n  var dialogNode = {\n    show: function show() {\n      visible.value = true;\n    },\n    hide: function hide() {\n      visible.value = false;\n    },\n    update: function update(newOptions) {\n      dialog.update(omit_1(newOptions, [\"className\", \"style\"]));\n      updateClassNameStyle(newOptions.className, newOptions.style);\n    },\n    destroy: function destroy() {\n      visible.value = false;\n      setTimeout(function () {\n        dialogComponent.unmount();\n        wrapper.remove();\n      }, 300);\n    },\n    setConfirmLoading: function setConfirmLoading(val) {\n      dialog.update({\n        confirmLoading: val\n      });\n    }\n  };\n  return dialogNode;\n};\nvar confirm = function confirm(props) {\n  return createDialog(props);\n};\nvar alert = function alert(props) {\n  var options = _objectSpread({}, props);\n  options.cancelBtn = null;\n  return createDialog(options);\n};\nvar extraApi = {\n  confirm: confirm,\n  alert: alert\n};\nvar DialogPlugin = createDialog;\nDialogPlugin.install = function (app) {\n  app.config.globalProperties.$dialog = createDialog;\n  Object.keys(extraApi).forEach(function (funcName) {\n    app.config.globalProperties.$dialog[funcName] = extraApi[funcName];\n  });\n};\nObject.keys(extraApi).forEach(function (funcName) {\n  DialogPlugin[funcName] = extraApi[funcName];\n});\nexport { DialogPlugin, DialogPlugin as default };","map":{"version":3,"names":["createDialog","props","options","_objectSpread","wrapper","document","createElement","visible","ref","className","style","preClassName","updateClassNameStyle","className2","style2","_wrapper$firstElement","firstElementChild","classList","remove","apply","_toConsumableArray","split","map","name","trim","forEach","add","cssText","component","defineComponent","setup","props2","_ref","expose","dialogOptions","onMounted","value","activeElement","blur","nextTick","update","newOptions","onClose","h","_Dialog","dialogComponent","createApp","dialog","mount","container","getAttach","attach","appendChild","console","error","dialogNode","show","hide","omit_1","destroy","setTimeout","unmount","setConfirmLoading","val","confirmLoading","confirm","alert","cancelBtn","extraApi","DialogPlugin","install","app","config","globalProperties","$dialog","Object","keys","funcName"],"sources":["../../src/dialog/plugin.tsx"],"sourcesContent":["import { App, createApp, ref, Plugin, defineComponent, h, onMounted, nextTick } from 'vue';\nimport DialogComponent from './dialog';\nimport { getAttach } from '../utils/dom';\nimport { DialogOptions, DialogMethod, DialogConfirmMethod, DialogAlertMethod, DialogInstance } from './type';\nimport omit from 'lodash/omit';\n\nconst createDialog: DialogMethod = (props: DialogOptions) => {\n  const options = { ...props };\n  const wrapper = document.createElement('div');\n  const visible = ref(false);\n  const { className, style } = options;\n\n  let preClassName = className;\n\n  const updateClassNameStyle = (className: string, style: DialogOptions['style']) => {\n    if (className) {\n      if (preClassName && preClassName !== className) {\n        wrapper.firstElementChild.classList.remove(...preClassName.split(' ').map((name) => name.trim()));\n      }\n      className.split(' ').forEach((name) => {\n        wrapper.firstElementChild.classList.add(name.trim());\n      });\n    }\n\n    if (style) {\n      (wrapper.firstElementChild as HTMLElement).style.cssText += style;\n    }\n\n    preClassName = className;\n  };\n\n  const component = defineComponent({\n    setup(props, { expose }) {\n      const dialogOptions = ref<Record<string, any>>(options);\n      onMounted(() => {\n        visible.value = true;\n        // 处理 https://github.com/Tencent/tdesign-vue-next/issues/394\n        (document.activeElement as HTMLElement).blur();\n        // 避免元素未挂载就触发样式获取，子元素为空的问题\n        nextTick(() => {\n          updateClassNameStyle(className, style);\n        });\n      });\n      const update = (newOptions: DialogOptions) => {\n        dialogOptions.value = {\n          ...options,\n          ...newOptions,\n        };\n      };\n\n      expose({\n        update,\n      });\n\n      return () => {\n        const onClose =\n          options.onClose ||\n          function () {\n            visible.value = false;\n          };\n        delete options.className;\n        delete options.style;\n        return h(DialogComponent, {\n          onClose,\n          visible: visible.value,\n          ...dialogOptions.value,\n        });\n      };\n    },\n  });\n  const dialogComponent = createApp(component);\n  const dialog = dialogComponent.mount(wrapper);\n\n  const container = getAttach(options.attach);\n  if (container) {\n    container.appendChild(wrapper);\n  } else {\n    console.error('attach is not exist');\n  }\n\n  const dialogNode: DialogInstance = {\n    show: () => {\n      visible.value = true;\n    },\n    hide: () => {\n      visible.value = false;\n    },\n    update: (newOptions: DialogOptions) => {\n      // className & style由updateClassNameStyle来处理\n      dialog.update(omit(newOptions, ['className', 'style']));\n      updateClassNameStyle(newOptions.className, newOptions.style);\n    },\n    destroy: () => {\n      visible.value = false;\n      setTimeout(() => {\n        dialogComponent.unmount();\n        wrapper.remove();\n      }, 300);\n    },\n    setConfirmLoading: (val: boolean) => {\n      dialog.update({ confirmLoading: val });\n    },\n  };\n  return dialogNode;\n};\ninterface ExtraApi {\n  confirm: DialogConfirmMethod;\n  alert: DialogAlertMethod;\n}\n\nconst confirm: DialogConfirmMethod = (props: DialogOptions) => createDialog(props);\n\nconst alert: DialogAlertMethod = (props: Omit<DialogOptions, 'confirmBtn'>) => {\n  const options = { ...props };\n  options.cancelBtn = null;\n  return createDialog(options);\n};\n\nconst extraApi: ExtraApi = {\n  confirm,\n  alert,\n};\n\nexport type DialogPluginType = Plugin & ExtraApi & DialogMethod;\n\nexport const DialogPlugin = createDialog as DialogPluginType;\n\nDialogPlugin.install = (app: App): void => {\n  app.config.globalProperties.$dialog = createDialog;\n  Object.keys(extraApi).forEach((funcName) => {\n    app.config.globalProperties.$dialog[funcName] = extraApi[funcName];\n  });\n};\n\nObject.keys(extraApi).forEach((funcName) => {\n  DialogPlugin[funcName] = extraApi[funcName];\n});\n\nexport default DialogPlugin;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}